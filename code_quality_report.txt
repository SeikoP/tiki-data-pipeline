Code Quality Report - 2025-11-15 16:30:50
============================================================


============================================================
Ruff PERF
============================================================
All checks passed!


============================================================
Ruff All
============================================================
[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:7:5
   [1m[94m|[0m
[1m[94m 5 |[0m   # Export error handling modules tá»« resilience
[1m[94m 6 |[0m   try:
[1m[94m 7 |[0m [1m[91m/[0m     from .resilience import (
[1m[94m 8 |[0m [1m[91m|[0m         # Exceptions
[1m[94m 9 |[0m [1m[91m|[0m         CrawlError,
[1m[94m10 |[0m [1m[91m|[0m         NetworkError,
[1m[94m11 |[0m [1m[91m|[0m         ParseError,
[1m[94m12 |[0m [1m[91m|[0m         StorageError,
[1m[94m13 |[0m [1m[91m|[0m         ValidationError,
[1m[94m14 |[0m [1m[91m|[0m         RateLimitError,
[1m[94m15 |[0m [1m[91m|[0m         TimeoutError,
[1m[94m16 |[0m [1m[91m|[0m         SeleniumError,
[1m[94m17 |[0m [1m[91m|[0m         ConfigurationError,
[1m[94m18 |[0m [1m[91m|[0m         classify_error,
[1m[94m19 |[0m [1m[91m|[0m         # Circuit Breaker
[1m[94m20 |[0m [1m[91m|[0m         CircuitBreaker,
[1m[94m21 |[0m [1m[91m|[0m         CircuitBreakerOpenError,
[1m[94m22 |[0m [1m[91m|[0m         CircuitState,
[1m[94m23 |[0m [1m[91m|[0m         circuit_breaker,
[1m[94m24 |[0m [1m[91m|[0m         # Dead Letter Queue
[1m[94m25 |[0m [1m[91m|[0m         DeadLetterQueue,
[1m[94m26 |[0m [1m[91m|[0m         get_dlq,
[1m[94m27 |[0m [1m[91m|[0m         # Graceful Degradation
[1m[94m28 |[0m [1m[91m|[0m         GracefulDegradation,
[1m[94m29 |[0m [1m[91m|[0m         DegradationLevel,
[1m[94m30 |[0m [1m[91m|[0m         ServiceHealth,
[1m[94m31 |[0m [1m[91m|[0m         get_service_health,
[1m[94m32 |[0m [1m[91m|[0m         graceful_degradation,
[1m[94m33 |[0m [1m[91m|[0m         # Error Handler
[1m[94m34 |[0m [1m[91m|[0m         ErrorHandler,
[1m[94m35 |[0m [1m[91m|[0m         with_error_handling,
[1m[94m36 |[0m [1m[91m|[0m     )
   [1m[94m|[0m [1m[91m|_____^[0m
[1m[94m37 |[0m       _ERROR_HANDLING_AVAILABLE = True
[1m[94m38 |[0m   except ImportError:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[1m`.resilience.CrawlError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:9:9
   [1m[94m|[0m
[1m[94m 7 |[0m     from .resilience import (
[1m[94m 8 |[0m         # Exceptions
[1m[94m 9 |[0m         CrawlError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^[0m
[1m[94m10 |[0m         NetworkError,
[1m[94m11 |[0m         ParseError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.NetworkError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:10:9
   [1m[94m|[0m
[1m[94m 8 |[0m         # Exceptions
[1m[94m 9 |[0m         CrawlError,
[1m[94m10 |[0m         NetworkError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^[0m
[1m[94m11 |[0m         ParseError,
[1m[94m12 |[0m         StorageError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.ParseError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:11:9
   [1m[94m|[0m
[1m[94m 9 |[0m         CrawlError,
[1m[94m10 |[0m         NetworkError,
[1m[94m11 |[0m         ParseError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^[0m
[1m[94m12 |[0m         StorageError,
[1m[94m13 |[0m         ValidationError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.StorageError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:12:9
   [1m[94m|[0m
[1m[94m10 |[0m         NetworkError,
[1m[94m11 |[0m         ParseError,
[1m[94m12 |[0m         StorageError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^[0m
[1m[94m13 |[0m         ValidationError,
[1m[94m14 |[0m         RateLimitError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.ValidationError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:13:9
   [1m[94m|[0m
[1m[94m11 |[0m         ParseError,
[1m[94m12 |[0m         StorageError,
[1m[94m13 |[0m         ValidationError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m14 |[0m         RateLimitError,
[1m[94m15 |[0m         TimeoutError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.RateLimitError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:14:9
   [1m[94m|[0m
[1m[94m12 |[0m         StorageError,
[1m[94m13 |[0m         ValidationError,
[1m[94m14 |[0m         RateLimitError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^[0m
[1m[94m15 |[0m         TimeoutError,
[1m[94m16 |[0m         SeleniumError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.TimeoutError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:15:9
   [1m[94m|[0m
[1m[94m13 |[0m         ValidationError,
[1m[94m14 |[0m         RateLimitError,
[1m[94m15 |[0m         TimeoutError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^[0m
[1m[94m16 |[0m         SeleniumError,
[1m[94m17 |[0m         ConfigurationError,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.SeleniumError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:16:9
   [1m[94m|[0m
[1m[94m14 |[0m         RateLimitError,
[1m[94m15 |[0m         TimeoutError,
[1m[94m16 |[0m         SeleniumError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^[0m
[1m[94m17 |[0m         ConfigurationError,
[1m[94m18 |[0m         classify_error,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.ConfigurationError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:17:9
   [1m[94m|[0m
[1m[94m15 |[0m         TimeoutError,
[1m[94m16 |[0m         SeleniumError,
[1m[94m17 |[0m         ConfigurationError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m18 |[0m         classify_error,
[1m[94m19 |[0m         # Circuit Breaker
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.classify_error` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:18:9
   [1m[94m|[0m
[1m[94m16 |[0m         SeleniumError,
[1m[94m17 |[0m         ConfigurationError,
[1m[94m18 |[0m         classify_error,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^[0m
[1m[94m19 |[0m         # Circuit Breaker
[1m[94m20 |[0m         CircuitBreaker,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.CircuitBreaker` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:20:9
   [1m[94m|[0m
[1m[94m18 |[0m         classify_error,
[1m[94m19 |[0m         # Circuit Breaker
[1m[94m20 |[0m         CircuitBreaker,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^[0m
[1m[94m21 |[0m         CircuitBreakerOpenError,
[1m[94m22 |[0m         CircuitState,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.CircuitBreakerOpenError` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:21:9
   [1m[94m|[0m
[1m[94m19 |[0m         # Circuit Breaker
[1m[94m20 |[0m         CircuitBreaker,
[1m[94m21 |[0m         CircuitBreakerOpenError,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m22 |[0m         CircuitState,
[1m[94m23 |[0m         circuit_breaker,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.CircuitState` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:22:9
   [1m[94m|[0m
[1m[94m20 |[0m         CircuitBreaker,
[1m[94m21 |[0m         CircuitBreakerOpenError,
[1m[94m22 |[0m         CircuitState,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^[0m
[1m[94m23 |[0m         circuit_breaker,
[1m[94m24 |[0m         # Dead Letter Queue
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.circuit_breaker` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:23:9
   [1m[94m|[0m
[1m[94m21 |[0m         CircuitBreakerOpenError,
[1m[94m22 |[0m         CircuitState,
[1m[94m23 |[0m         circuit_breaker,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m24 |[0m         # Dead Letter Queue
[1m[94m25 |[0m         DeadLetterQueue,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.DeadLetterQueue` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:25:9
   [1m[94m|[0m
[1m[94m23 |[0m         circuit_breaker,
[1m[94m24 |[0m         # Dead Letter Queue
[1m[94m25 |[0m         DeadLetterQueue,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m26 |[0m         get_dlq,
[1m[94m27 |[0m         # Graceful Degradation
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.get_dlq` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:26:9
   [1m[94m|[0m
[1m[94m24 |[0m         # Dead Letter Queue
[1m[94m25 |[0m         DeadLetterQueue,
[1m[94m26 |[0m         get_dlq,
   [1m[94m|[0m         [1m[91m^^^^^^^[0m
[1m[94m27 |[0m         # Graceful Degradation
[1m[94m28 |[0m         GracefulDegradation,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.GracefulDegradation` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:28:9
   [1m[94m|[0m
[1m[94m26 |[0m         get_dlq,
[1m[94m27 |[0m         # Graceful Degradation
[1m[94m28 |[0m         GracefulDegradation,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m29 |[0m         DegradationLevel,
[1m[94m30 |[0m         ServiceHealth,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.DegradationLevel` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:29:9
   [1m[94m|[0m
[1m[94m27 |[0m         # Graceful Degradation
[1m[94m28 |[0m         GracefulDegradation,
[1m[94m29 |[0m         DegradationLevel,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m30 |[0m         ServiceHealth,
[1m[94m31 |[0m         get_service_health,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.ServiceHealth` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:30:9
   [1m[94m|[0m
[1m[94m28 |[0m         GracefulDegradation,
[1m[94m29 |[0m         DegradationLevel,
[1m[94m30 |[0m         ServiceHealth,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^[0m
[1m[94m31 |[0m         get_service_health,
[1m[94m32 |[0m         graceful_degradation,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.get_service_health` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:31:9
   [1m[94m|[0m
[1m[94m29 |[0m         DegradationLevel,
[1m[94m30 |[0m         ServiceHealth,
[1m[94m31 |[0m         get_service_health,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m32 |[0m         graceful_degradation,
[1m[94m33 |[0m         # Error Handler
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.graceful_degradation` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:32:9
   [1m[94m|[0m
[1m[94m30 |[0m         ServiceHealth,
[1m[94m31 |[0m         get_service_health,
[1m[94m32 |[0m         graceful_degradation,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m33 |[0m         # Error Handler
[1m[94m34 |[0m         ErrorHandler,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.ErrorHandler` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:34:9
   [1m[94m|[0m
[1m[94m32 |[0m         graceful_degradation,
[1m[94m33 |[0m         # Error Handler
[1m[94m34 |[0m         ErrorHandler,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^[0m
[1m[94m35 |[0m         with_error_handling,
[1m[94m36 |[0m     )
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.resilience.with_error_handling` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\__init__.py:35:9
   [1m[94m|[0m
[1m[94m33 |[0m         # Error Handler
[1m[94m34 |[0m         ErrorHandler,
[1m[94m35 |[0m         with_error_handling,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m36 |[0m     )
[1m[94m37 |[0m     _ERROR_HANDLING_AVAILABLE = True
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\error_handling.py:6:1
   [1m[94m|[0m
[1m[94m 4 |[0m   """
[1m[94m 5 |[0m
[1m[94m 6 |[0m [1m[91m/[0m from .resilience import (
[1m[94m 7 |[0m [1m[91m|[0m     CrawlError,
[1m[94m 8 |[0m [1m[91m|[0m     NetworkError,
[1m[94m 9 |[0m [1m[91m|[0m     ParseError,
[1m[94m10 |[0m [1m[91m|[0m     StorageError,
[1m[94m11 |[0m [1m[91m|[0m     ValidationError,
[1m[94m12 |[0m [1m[91m|[0m     RateLimitError,
[1m[94m13 |[0m [1m[91m|[0m     TimeoutError,
[1m[94m14 |[0m [1m[91m|[0m     SeleniumError,
[1m[94m15 |[0m [1m[91m|[0m     ConfigurationError,
[1m[94m16 |[0m [1m[91m|[0m     classify_error,
[1m[94m17 |[0m [1m[91m|[0m     CircuitBreaker,
[1m[94m18 |[0m [1m[91m|[0m     CircuitBreakerOpenError,
[1m[94m19 |[0m [1m[91m|[0m     CircuitState,
[1m[94m20 |[0m [1m[91m|[0m     circuit_breaker,
[1m[94m21 |[0m [1m[91m|[0m     DeadLetterQueue,
[1m[94m22 |[0m [1m[91m|[0m     get_dlq,
[1m[94m23 |[0m [1m[91m|[0m     GracefulDegradation,
[1m[94m24 |[0m [1m[91m|[0m     DegradationLevel,
[1m[94m25 |[0m [1m[91m|[0m     ServiceHealth,
[1m[94m26 |[0m [1m[91m|[0m     get_service_health,
[1m[94m27 |[0m [1m[91m|[0m     graceful_degradation,
[1m[94m28 |[0m [1m[91m|[0m     ErrorHandler,
[1m[94m29 |[0m [1m[91m|[0m     with_error_handling,
[1m[94m30 |[0m [1m[91m|[0m )
   [1m[94m|[0m [1m[91m|_^[0m
[1m[94m31 |[0m
[1m[94m32 |[0m   __all__ = [
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\__init__.py:5:1
   [1m[94m|[0m
[1m[94m 3 |[0m   """
[1m[94m 4 |[0m
[1m[94m 5 |[0m [1m[91m/[0m from .exceptions import (
[1m[94m 6 |[0m [1m[91m|[0m     CrawlError,
[1m[94m 7 |[0m [1m[91m|[0m     NetworkError,
[1m[94m 8 |[0m [1m[91m|[0m     ParseError,
[1m[94m 9 |[0m [1m[91m|[0m     StorageError,
[1m[94m10 |[0m [1m[91m|[0m     ValidationError,
[1m[94m11 |[0m [1m[91m|[0m     RateLimitError,
[1m[94m12 |[0m [1m[91m|[0m     TimeoutError,
[1m[94m13 |[0m [1m[91m|[0m     SeleniumError,
[1m[94m14 |[0m [1m[91m|[0m     ConfigurationError,
[1m[94m15 |[0m [1m[91m|[0m     classify_error,
[1m[94m16 |[0m [1m[91m|[0m )
[1m[94m17 |[0m [1m[91m|[0m
[1m[94m18 |[0m [1m[91m|[0m from .circuit_breaker import (
[1m[94m19 |[0m [1m[91m|[0m     CircuitBreaker,
[1m[94m20 |[0m [1m[91m|[0m     CircuitBreakerOpenError,
[1m[94m21 |[0m [1m[91m|[0m     CircuitState,
[1m[94m22 |[0m [1m[91m|[0m     circuit_breaker,
[1m[94m23 |[0m [1m[91m|[0m )
[1m[94m24 |[0m [1m[91m|[0m
[1m[94m25 |[0m [1m[91m|[0m from .dead_letter_queue import (
[1m[94m26 |[0m [1m[91m|[0m     DeadLetterQueue,
[1m[94m27 |[0m [1m[91m|[0m     get_dlq,
[1m[94m28 |[0m [1m[91m|[0m )
[1m[94m29 |[0m [1m[91m|[0m
[1m[94m30 |[0m [1m[91m|[0m from .graceful_degradation import (
[1m[94m31 |[0m [1m[91m|[0m     GracefulDegradation,
[1m[94m32 |[0m [1m[91m|[0m     DegradationLevel,
[1m[94m33 |[0m [1m[91m|[0m     ServiceHealth,
[1m[94m34 |[0m [1m[91m|[0m     get_service_health,
[1m[94m35 |[0m [1m[91m|[0m     graceful_degradation,
[1m[94m36 |[0m [1m[91m|[0m )
[1m[94m37 |[0m [1m[91m|[0m
[1m[94m38 |[0m [1m[91m|[0m from .error_handler import (
[1m[94m39 |[0m [1m[91m|[0m     ErrorHandler,
[1m[94m40 |[0m [1m[91m|[0m     with_error_handling,
[1m[94m41 |[0m [1m[91m|[0m )
   [1m[94m|[0m [1m[91m|_^[0m
[1m[94m42 |[0m
[1m[94m43 |[0m   __all__ = [
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:6:1
   [1m[94m|[0m
[1m[94m 4 |[0m   """
[1m[94m 5 |[0m
[1m[94m 6 |[0m [1m[91m/[0m import time
[1m[94m 7 |[0m [1m[91m|[0m from enum import Enum
[1m[94m 8 |[0m [1m[91m|[0m from typing import Callable, Optional, Any, TypeVar
[1m[94m 9 |[0m [1m[91m|[0m from threading import Lock
[1m[94m10 |[0m [1m[91m|[0m from datetime import datetime
   [1m[94m|[0m [1m[91m|_____________________________^[0m
[1m[94m11 |[0m
[1m[94m12 |[0m   T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`time` imported but unused[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:6:8
  [1m[94m|[0m
[1m[94m4 |[0m """
[1m[94m5 |[0m
[1m[94m6 |[0m import time
  [1m[94m|[0m        [1m[91m^^^^[0m
[1m[94m7 |[0m from enum import Enum
[1m[94m8 |[0m from typing import Callable, Optional, Any, TypeVar
  [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import: `time`[0m

[1m[91mUP035 [0m[[1m[96m*[0m] [1mImport from `collections.abc` instead: `Callable`[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:8:1
   [1m[94m|[0m
[1m[94m 6 |[0m import time
[1m[94m 7 |[0m from enum import Enum
[1m[94m 8 |[0m from typing import Callable, Optional, Any, TypeVar
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m 9 |[0m from threading import Lock
[1m[94m10 |[0m from datetime import datetime
   [1m[94m|[0m
[1m[96mhelp[0m: [1mImport from `collections.abc`[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`typing.Any` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:8:40
   [1m[94m|[0m
[1m[94m 6 |[0m import time
[1m[94m 7 |[0m from enum import Enum
[1m[94m 8 |[0m from typing import Callable, Optional, Any, TypeVar
   [1m[94m|[0m                                        [1m[91m^^^[0m
[1m[94m 9 |[0m from threading import Lock
[1m[94m10 |[0m from datetime import datetime
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import: `typing.Any`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:25:1
   [1m[94m|[0m
[1m[94m23 |[0m     """
[1m[94m24 |[0m     Circuit Breaker Ä‘á»ƒ báº£o vá»‡ service khá»i cascade failure
[1m[94m25 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m26 |[0m     Khi sá»‘ lá»—i vÆ°á»£t quÃ¡ threshold trong má»™t khoáº£ng thá»i gian,
[1m[94m27 |[0m     circuit sáº½ má»Ÿ vÃ  tá»« chá»‘i táº¥t cáº£ requests cho Ä‘áº¿n khi recovery.
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:29:1
   [1m[94m|[0m
[1m[94m27 |[0m     circuit sáº½ má»Ÿ vÃ  tá»« chá»‘i táº¥t cáº£ requests cho Ä‘áº¿n khi recovery.
[1m[94m28 |[0m     """
[1m[94m29 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m30 |[0m     def __init__(
[1m[94m31 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:48:1
   [1m[94m|[0m
[1m[94m46 |[0m         self.expected_exception = expected_exception
[1m[94m47 |[0m         self.name = name
[1m[94m48 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m49 |[0m         self.state = CircuitState.CLOSED
[1m[94m50 |[0m         self.failure_count = 0
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:52:33
   [1m[94m|[0m
[1m[94m50 |[0m         self.failure_count = 0
[1m[94m51 |[0m         self.success_count = 0
[1m[94m52 |[0m         self.last_failure_time: Optional[datetime] = None
   [1m[94m|[0m                                 [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m53 |[0m         self.last_success_time: Optional[datetime] = None
[1m[94m54 |[0m         self.opened_at: Optional[datetime] = None
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:53:33
   [1m[94m|[0m
[1m[94m51 |[0m         self.success_count = 0
[1m[94m52 |[0m         self.last_failure_time: Optional[datetime] = None
[1m[94m53 |[0m         self.last_success_time: Optional[datetime] = None
   [1m[94m|[0m                                 [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m54 |[0m         self.opened_at: Optional[datetime] = None
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:54:25
   [1m[94m|[0m
[1m[94m52 |[0m         self.last_failure_time: Optional[datetime] = None
[1m[94m53 |[0m         self.last_success_time: Optional[datetime] = None
[1m[94m54 |[0m         self.opened_at: Optional[datetime] = None
   [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m55 |[0m         
[1m[94m56 |[0m         self._lock = Lock()
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:55:1
   [1m[94m|[0m
[1m[94m53 |[0m         self.last_success_time: Optional[datetime] = None
[1m[94m54 |[0m         self.opened_at: Optional[datetime] = None
[1m[94m55 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m56 |[0m         self._lock = Lock()
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:57:1
   [1m[94m|[0m
[1m[94m56 |[0m         self._lock = Lock()
[1m[94m57 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m58 |[0m     def call(self, func: Callable[..., T], *args, **kwargs) -> T:
[1m[94m59 |[0m         """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:61:1
   [1m[94m|[0m
[1m[94m59 |[0m         """
[1m[94m60 |[0m         Gá»i function vá»›i circuit breaker protection
[1m[94m61 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m62 |[0m         Args:
[1m[94m63 |[0m             func: Function cáº§n gá»i
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:65:1
   [1m[94m|[0m
[1m[94m63 |[0m             func: Function cáº§n gá»i
[1m[94m64 |[0m             *args, **kwargs: Arguments cho function
[1m[94m65 |[0m             
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m66 |[0m         Returns:
[1m[94m67 |[0m             Káº¿t quáº£ tá»« function
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:68:1
   [1m[94m|[0m
[1m[94m66 |[0m         Returns:
[1m[94m67 |[0m             Káº¿t quáº£ tá»« function
[1m[94m68 |[0m             
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m69 |[0m         Raises:
[1m[94m70 |[0m             CircuitBreakerOpenError: Náº¿u circuit Ä‘ang má»Ÿ
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:86:1
   [1m[94m|[0m
[1m[94m84 |[0m                         f"Will retry after {self.recovery_timeout}s"
[1m[94m85 |[0m                     )
[1m[94m86 |[0m             
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m87 |[0m             # Gá»i function
[1m[94m88 |[0m             try:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mF841 [0m[[1m[96m*[0m] [1mLocal variable `e` is assigned to but never used[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:92:47
   [1m[94m|[0m
[1m[94m90 |[0m                 self._on_success()
[1m[94m91 |[0m                 return result
[1m[94m92 |[0m             except self.expected_exception as e:
   [1m[94m|[0m                                               [1m[91m^[0m
[1m[94m93 |[0m                 self._on_failure()
[1m[94m94 |[0m                 raise
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove assignment to unused variable `e`[0m

[1m[91mF841 [0m[[1m[96m*[0m] [1mLocal variable `e` is assigned to but never used[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:95:33
   [1m[94m|[0m
[1m[94m93 |[0m                 self._on_failure()
[1m[94m94 |[0m                 raise
[1m[94m95 |[0m             except Exception as e:
   [1m[94m|[0m                                 [1m[91m^[0m
[1m[94m96 |[0m                 # Exception khÃ´ng pháº£i expected_exception -> khÃ´ng tÃ­nh lÃ  failure
[1m[94m97 |[0m                 # NhÆ°ng váº«n raise
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove assignment to unused variable `e`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:99:1
    [1m[94m|[0m
[1m[94m 97 |[0m                 # NhÆ°ng váº«n raise
[1m[94m 98 |[0m                 raise
[1m[94m 99 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m100 |[0m     def _should_attempt_reset(self) -> bool:
[1m[94m101 |[0m         """Kiá»ƒm tra xem cÃ³ nÃªn thá»­ reset circuit khÃ´ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:106:1
    [1m[94m|[0m
[1m[94m104 |[0m         elapsed = (datetime.now() - self.opened_at).total_seconds()
[1m[94m105 |[0m         return elapsed >= self.recovery_timeout
[1m[94m106 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m107 |[0m     def _on_success(self):
[1m[94m108 |[0m         """Xá»­ lÃ½ khi call thÃ nh cÃ´ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:110:1
    [1m[94m|[0m
[1m[94m108 |[0m         """Xá»­ lÃ½ khi call thÃ nh cÃ´ng"""
[1m[94m109 |[0m         self.last_success_time = datetime.now()
[1m[94m110 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m111 |[0m         if self.state == CircuitState.HALF_OPEN:
[1m[94m112 |[0m             # Trong half-open, cáº§n má»™t sá»‘ success Ä‘á»ƒ Ä‘Ã³ng láº¡i
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:122:1
    [1m[94m|[0m
[1m[94m120 |[0m             # Reset failure count khi cÃ³ success
[1m[94m121 |[0m             self.failure_count = 0
[1m[94m122 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m123 |[0m     def _on_failure(self):
[1m[94m124 |[0m         """Xá»­ lÃ½ khi call tháº¥t báº¡i"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:127:1
    [1m[94m|[0m
[1m[94m125 |[0m         self.last_failure_time = datetime.now()
[1m[94m126 |[0m         self.failure_count += 1
[1m[94m127 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m128 |[0m         if self.state == CircuitState.HALF_OPEN:
[1m[94m129 |[0m             # Trong half-open mÃ  fail -> má»Ÿ láº¡i
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:138:1
    [1m[94m|[0m
[1m[94m136 |[0m                 self.state = CircuitState.OPEN
[1m[94m137 |[0m                 self.opened_at = datetime.now()
[1m[94m138 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m139 |[0m     def reset(self):
[1m[94m140 |[0m         """Reset circuit vá» tráº¡ng thÃ¡i closed"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:147:1
    [1m[94m|[0m
[1m[94m145 |[0m             self.last_failure_time = None
[1m[94m146 |[0m             self.opened_at = None
[1m[94m147 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m148 |[0m     def get_state(self) -> dict:
[1m[94m149 |[0m         """Láº¥y thÃ´ng tin state cá»§a circuit breaker"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:170:11
    [1m[94m|[0m
[1m[94m168 |[0m     recovery_timeout: int = 60,
[1m[94m169 |[0m     expected_exception: type = Exception,
[1m[94m170 |[0m     name: Optional[str] = None,
    [1m[94m|[0m           [1m[91m^^^^^^^^^^^^^[0m
[1m[94m171 |[0m ):
[1m[94m172 |[0m     """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:174:1
    [1m[94m|[0m
[1m[94m172 |[0m     """
[1m[94m173 |[0m     Decorator Ä‘á»ƒ Ã¡p dá»¥ng circuit breaker cho function
[1m[94m174 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m175 |[0m     Args:
[1m[94m176 |[0m         failure_threshold: Sá»‘ lá»—i tá»‘i Ä‘a
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:180:1
    [1m[94m|[0m
[1m[94m178 |[0m         expected_exception: Loáº¡i exception Ä‘Æ°á»£c coi lÃ  failure
[1m[94m179 |[0m         name: TÃªn circuit breaker (máº·c Ä‘á»‹nh: tÃªn function)
[1m[94m180 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m181 |[0m     Example:
[1m[94m182 |[0m         @circuit_breaker(failure_threshold=5, recovery_timeout=60)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:194:1
    [1m[94m|[0m
[1m[94m192 |[0m             name=cb_name,
[1m[94m193 |[0m         )
[1m[94m194 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m195 |[0m         def wrapper(*args, **kwargs) -> T:
[1m[94m196 |[0m             return breaker.call(func, *args, **kwargs)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:197:1
    [1m[94m|[0m
[1m[94m195 |[0m         def wrapper(*args, **kwargs) -> T:
[1m[94m196 |[0m             return breaker.call(func, *args, **kwargs)
[1m[94m197 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m198 |[0m         # Attach breaker Ä‘á»ƒ cÃ³ thá»ƒ access
[1m[94m199 |[0m         wrapper.circuit_breaker = breaker
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\circuit_breaker.py:201:1
    [1m[94m|[0m
[1m[94m199 |[0m         wrapper.circuit_breaker = breaker
[1m[94m200 |[0m         return wrapper
[1m[94m201 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m202 |[0m     return decorator
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:6:1
   [1m[94m|[0m
[1m[94m 4 |[0m   """
[1m[94m 5 |[0m
[1m[94m 6 |[0m [1m[91m/[0m import json
[1m[94m 7 |[0m [1m[91m|[0m import time
[1m[94m 8 |[0m [1m[91m|[0m from datetime import datetime
[1m[94m 9 |[0m [1m[91m|[0m from pathlib import Path
[1m[94m10 |[0m [1m[91m|[0m from typing import Any, Dict, List, Optional
[1m[94m11 |[0m [1m[91m|[0m from threading import Lock
   [1m[94m|[0m [1m[91m|__________________________^[0m
[1m[94m12 |[0m
[1m[94m13 |[0m   try:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mUP035 [0m[1m`typing.Dict` is deprecated, use `dict` instead[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:10:1
   [1m[94m|[0m
[1m[94m 8 |[0m from datetime import datetime
[1m[94m 9 |[0m from pathlib import Path
[1m[94m10 |[0m from typing import Any, Dict, List, Optional
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m11 |[0m from threading import Lock
   [1m[94m|[0m

[1m[91mUP035 [0m[1m`typing.List` is deprecated, use `list` instead[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:10:1
   [1m[94m|[0m
[1m[94m 8 |[0m from datetime import datetime
[1m[94m 9 |[0m from pathlib import Path
[1m[94m10 |[0m from typing import Any, Dict, List, Optional
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m11 |[0m from threading import Lock
   [1m[94m|[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:24:1
   [1m[94m|[0m
[1m[94m22 |[0m     """
[1m[94m23 |[0m     Dead Letter Queue Ä‘á»ƒ lÆ°u trá»¯ failed tasks
[1m[94m24 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m25 |[0m     Há»— trá»£ cáº£ file-based vÃ  Redis-based storage
[1m[94m26 |[0m     """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:27:1
   [1m[94m|[0m
[1m[94m25 |[0m     Há»— trá»£ cáº£ file-based vÃ  Redis-based storage
[1m[94m26 |[0m     """
[1m[94m27 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m28 |[0m     def __init__(
[1m[94m29 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:31:23
   [1m[94m|[0m
[1m[94m29 |[0m         self,
[1m[94m30 |[0m         storage_type: str = "file",  # "file" hoáº·c "redis"
[1m[94m31 |[0m         storage_path: Optional[str | Path] = None,
   [1m[94m|[0m                       [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m32 |[0m         redis_url: Optional[str] = None,
[1m[94m33 |[0m         max_items: int = 10000,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:32:20
   [1m[94m|[0m
[1m[94m30 |[0m         storage_type: str = "file",  # "file" hoáº·c "redis"
[1m[94m31 |[0m         storage_path: Optional[str | Path] = None,
[1m[94m32 |[0m         redis_url: Optional[str] = None,
   [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m33 |[0m         max_items: int = 10000,
[1m[94m34 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:45:1
   [1m[94m|[0m
[1m[94m43 |[0m         self.max_items = max_items
[1m[94m44 |[0m         self._lock = Lock()
[1m[94m45 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m46 |[0m         if storage_type == "file":
[1m[94m47 |[0m             if storage_path is None:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:62:1
   [1m[94m|[0m
[1m[94m60 |[0m         else:
[1m[94m61 |[0m             raise ValueError(f"Unknown storage_type: {storage_type}")
[1m[94m62 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m63 |[0m     def add(
[1m[94m64 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:68:18
   [1m[94m|[0m
[1m[94m66 |[0m         task_type: str,
[1m[94m67 |[0m         error: Exception,
[1m[94m68 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m69 |[0m         retry_count: int = 0,
[1m[94m70 |[0m     ) -> bool:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:68:27
   [1m[94m|[0m
[1m[94m66 |[0m         task_type: str,
[1m[94m67 |[0m         error: Exception,
[1m[94m68 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m69 |[0m         retry_count: int = 0,
[1m[94m70 |[0m     ) -> bool:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:73:1
   [1m[94m|[0m
[1m[94m71 |[0m         """
[1m[94m72 |[0m         ThÃªm failed task vÃ o DLQ
[1m[94m73 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m74 |[0m         Args:
[1m[94m75 |[0m             task_id: ID cá»§a task
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:80:1
   [1m[94m|[0m
[1m[94m78 |[0m             context: Context thÃªm (URL, product_id, etc.)
[1m[94m79 |[0m             retry_count: Sá»‘ láº§n Ä‘Ã£ retry
[1m[94m80 |[0m             
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m81 |[0m         Returns:
[1m[94m82 |[0m             True náº¿u thÃ nh cÃ´ng
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:89:1
   [1m[94m|[0m
[1m[94m87 |[0m                 # XÃ³a items cÅ© nháº¥t
[1m[94m88 |[0m                 self._remove_oldest(100)
[1m[94m89 |[0m             
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m90 |[0m             # Táº¡o DLQ entry
[1m[94m91 |[0m             entry = {
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:102:1
    [1m[94m|[0m
[1m[94m100 |[0m                 "timestamp": time.time(),
[1m[94m101 |[0m             }
[1m[94m102 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m103 |[0m             if self.storage_type == "file":
[1m[94m104 |[0m                 return self._add_to_file(task_id, entry)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:107:1
    [1m[94m|[0m
[1m[94m105 |[0m             else:  # redis
[1m[94m106 |[0m                 return self._add_to_redis(task_id, entry)
[1m[94m107 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m108 |[0m     def _add_to_file(self, task_id: str, entry: Dict[str, Any]) -> bool:
[1m[94m109 |[0m         """ThÃªm entry vÃ o file"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:108:49
    [1m[94m|[0m
[1m[94m106 |[0m                 return self._add_to_redis(task_id, entry)
[1m[94m107 |[0m     
[1m[94m108 |[0m     def _add_to_file(self, task_id: str, entry: Dict[str, Any]) -> bool:
    [1m[94m|[0m                                                 [1m[91m^^^^[0m
[1m[94m109 |[0m         """ThÃªm entry vÃ o file"""
[1m[94m110 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:117:1
    [1m[94m|[0m
[1m[94m115 |[0m         except Exception:
[1m[94m116 |[0m             return False
[1m[94m117 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m118 |[0m     def _add_to_redis(self, task_id: str, entry: Dict[str, Any]) -> bool:
[1m[94m119 |[0m         """ThÃªm entry vÃ o Redis"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:118:50
    [1m[94m|[0m
[1m[94m116 |[0m             return False
[1m[94m117 |[0m     
[1m[94m118 |[0m     def _add_to_redis(self, task_id: str, entry: Dict[str, Any]) -> bool:
    [1m[94m|[0m                                                  [1m[91m^^^^[0m
[1m[94m119 |[0m         """ThÃªm entry vÃ o Redis"""
[1m[94m120 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:130:1
    [1m[94m|[0m
[1m[94m128 |[0m         except Exception:
[1m[94m129 |[0m             return False
[1m[94m130 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m131 |[0m     def get(self, task_id: str) -> Optional[Dict[str, Any]]:
[1m[94m132 |[0m         """Láº¥y entry tá»« DLQ"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:131:36
    [1m[94m|[0m
[1m[94m129 |[0m             return False
[1m[94m130 |[0m     
[1m[94m131 |[0m     def get(self, task_id: str) -> Optional[Dict[str, Any]]:
    [1m[94m|[0m                                    [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m132 |[0m         """Láº¥y entry tá»« DLQ"""
[1m[94m133 |[0m         if self.storage_type == "file":
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:131:45
    [1m[94m|[0m
[1m[94m129 |[0m             return False
[1m[94m130 |[0m     
[1m[94m131 |[0m     def get(self, task_id: str) -> Optional[Dict[str, Any]]:
    [1m[94m|[0m                                             [1m[91m^^^^[0m
[1m[94m132 |[0m         """Láº¥y entry tá»« DLQ"""
[1m[94m133 |[0m         if self.storage_type == "file":
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:137:1
    [1m[94m|[0m
[1m[94m135 |[0m         else:
[1m[94m136 |[0m             return self._get_from_redis(task_id)
[1m[94m137 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m138 |[0m     def _get_from_file(self, task_id: str) -> Optional[Dict[str, Any]]:
[1m[94m139 |[0m         """Láº¥y entry tá»« file"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:138:47
    [1m[94m|[0m
[1m[94m136 |[0m             return self._get_from_redis(task_id)
[1m[94m137 |[0m     
[1m[94m138 |[0m     def _get_from_file(self, task_id: str) -> Optional[Dict[str, Any]]:
    [1m[94m|[0m                                               [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m139 |[0m         """Láº¥y entry tá»« file"""
[1m[94m140 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:138:56
    [1m[94m|[0m
[1m[94m136 |[0m             return self._get_from_redis(task_id)
[1m[94m137 |[0m     
[1m[94m138 |[0m     def _get_from_file(self, task_id: str) -> Optional[Dict[str, Any]]:
    [1m[94m|[0m                                                        [1m[91m^^^^[0m
[1m[94m139 |[0m         """Láº¥y entry tá»« file"""
[1m[94m140 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP015 [0m[[1m[96m*[0m] [1mUnnecessary mode argument[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:144:33
    [1m[94m|[0m
[1m[94m142 |[0m             if not filepath.exists():
[1m[94m143 |[0m                 return None
[1m[94m144 |[0m             with open(filepath, "r", encoding="utf-8") as f:
    [1m[94m|[0m                                 [1m[91m^^^[0m
[1m[94m145 |[0m                 return json.load(f)
[1m[94m146 |[0m         except Exception:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove mode argument[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:148:1
    [1m[94m|[0m
[1m[94m146 |[0m         except Exception:
[1m[94m147 |[0m             return None
[1m[94m148 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m149 |[0m     def _get_from_redis(self, task_id: str) -> Optional[Dict[str, Any]]:
[1m[94m150 |[0m         """Láº¥y entry tá»« Redis"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:149:48
    [1m[94m|[0m
[1m[94m147 |[0m             return None
[1m[94m148 |[0m     
[1m[94m149 |[0m     def _get_from_redis(self, task_id: str) -> Optional[Dict[str, Any]]:
    [1m[94m|[0m                                                [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m150 |[0m         """Láº¥y entry tá»« Redis"""
[1m[94m151 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:149:57
    [1m[94m|[0m
[1m[94m147 |[0m             return None
[1m[94m148 |[0m     
[1m[94m149 |[0m     def _get_from_redis(self, task_id: str) -> Optional[Dict[str, Any]]:
    [1m[94m|[0m                                                         [1m[91m^^^^[0m
[1m[94m150 |[0m         """Láº¥y entry tá»« Redis"""
[1m[94m151 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:159:1
    [1m[94m|[0m
[1m[94m157 |[0m         except Exception:
[1m[94m158 |[0m             return None
[1m[94m159 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m160 |[0m     def remove(self, task_id: str) -> bool:
[1m[94m161 |[0m         """XÃ³a entry khá»i DLQ"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:167:1
    [1m[94m|[0m
[1m[94m165 |[0m             else:
[1m[94m166 |[0m                 return self._remove_from_redis(task_id)
[1m[94m167 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m168 |[0m     def _remove_from_file(self, task_id: str) -> bool:
[1m[94m169 |[0m         """XÃ³a entry tá»« file"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:178:1
    [1m[94m|[0m
[1m[94m176 |[0m         except Exception:
[1m[94m177 |[0m             return False
[1m[94m178 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m179 |[0m     def _remove_from_redis(self, task_id: str) -> bool:
[1m[94m180 |[0m         """XÃ³a entry tá»« Redis"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:188:1
    [1m[94m|[0m
[1m[94m186 |[0m         except Exception:
[1m[94m187 |[0m             return False
[1m[94m188 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m189 |[0m     def list_all(
[1m[94m190 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:191:20
    [1m[94m|[0m
[1m[94m189 |[0m     def list_all(
[1m[94m190 |[0m         self,
[1m[94m191 |[0m         task_type: Optional[str] = None,
    [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m192 |[0m         limit: int = 100,
[1m[94m193 |[0m         offset: int = 0,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:194:10
    [1m[94m|[0m
[1m[94m192 |[0m         limit: int = 100,
[1m[94m193 |[0m         offset: int = 0,
[1m[94m194 |[0m     ) -> List[Dict[str, Any]]:
    [1m[94m|[0m          [1m[91m^^^^[0m
[1m[94m195 |[0m         """
[1m[94m196 |[0m         Láº¥y danh sÃ¡ch táº¥t cáº£ entries
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:194:15
    [1m[94m|[0m
[1m[94m192 |[0m         limit: int = 100,
[1m[94m193 |[0m         offset: int = 0,
[1m[94m194 |[0m     ) -> List[Dict[str, Any]]:
    [1m[94m|[0m               [1m[91m^^^^[0m
[1m[94m195 |[0m         """
[1m[94m196 |[0m         Láº¥y danh sÃ¡ch táº¥t cáº£ entries
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:197:1
    [1m[94m|[0m
[1m[94m195 |[0m         """
[1m[94m196 |[0m         Láº¥y danh sÃ¡ch táº¥t cáº£ entries
[1m[94m197 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m198 |[0m         Args:
[1m[94m199 |[0m             task_type: Lá»c theo task type (None = táº¥t cáº£)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:202:1
    [1m[94m|[0m
[1m[94m200 |[0m             limit: Sá»‘ lÆ°á»£ng tá»‘i Ä‘a
[1m[94m201 |[0m             offset: Offset
[1m[94m202 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m203 |[0m         Returns:
[1m[94m204 |[0m             List entries
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:210:1
    [1m[94m|[0m
[1m[94m208 |[0m         else:
[1m[94m209 |[0m             return self._list_from_redis(task_type, limit, offset)
[1m[94m210 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m211 |[0m     def _list_from_file(
[1m[94m212 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:213:20
    [1m[94m|[0m
[1m[94m211 |[0m     def _list_from_file(
[1m[94m212 |[0m         self,
[1m[94m213 |[0m         task_type: Optional[str],
    [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m214 |[0m         limit: int,
[1m[94m215 |[0m         offset: int,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:216:10
    [1m[94m|[0m
[1m[94m214 |[0m         limit: int,
[1m[94m215 |[0m         offset: int,
[1m[94m216 |[0m     ) -> List[Dict[str, Any]]:
    [1m[94m|[0m          [1m[91m^^^^[0m
[1m[94m217 |[0m         """Láº¥y danh sÃ¡ch tá»« file"""
[1m[94m218 |[0m         entries = []
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:216:15
    [1m[94m|[0m
[1m[94m214 |[0m         limit: int,
[1m[94m215 |[0m         offset: int,
[1m[94m216 |[0m     ) -> List[Dict[str, Any]]:
    [1m[94m|[0m               [1m[91m^^^^[0m
[1m[94m217 |[0m         """Láº¥y danh sÃ¡ch tá»« file"""
[1m[94m218 |[0m         entries = []
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP015 [0m[[1m[96m*[0m] [1mUnnecessary mode argument[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:222:41
    [1m[94m|[0m
[1m[94m220 |[0m             for filepath in sorted(self.storage_path.glob("*.json")):
[1m[94m221 |[0m                 try:
[1m[94m222 |[0m                     with open(filepath, "r", encoding="utf-8") as f:
    [1m[94m|[0m                                         [1m[91m^^^[0m
[1m[94m223 |[0m                         entry = json.load(f)
[1m[94m224 |[0m                         if task_type is None or entry.get("task_type") == task_type:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove mode argument[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:228:1
    [1m[94m|[0m
[1m[94m226 |[0m                 except Exception:
[1m[94m227 |[0m                     continue
[1m[94m228 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m229 |[0m             # Sort theo timestamp (má»›i nháº¥t trÆ°á»›c)
[1m[94m230 |[0m             entries.sort(key=lambda x: x.get("timestamp", 0), reverse=True)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:234:1
    [1m[94m|[0m
[1m[94m232 |[0m         except Exception:
[1m[94m233 |[0m             return []
[1m[94m234 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m235 |[0m     def _list_from_redis(
[1m[94m236 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:237:20
    [1m[94m|[0m
[1m[94m235 |[0m     def _list_from_redis(
[1m[94m236 |[0m         self,
[1m[94m237 |[0m         task_type: Optional[str],
    [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m238 |[0m         limit: int,
[1m[94m239 |[0m         offset: int,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:240:10
    [1m[94m|[0m
[1m[94m238 |[0m         limit: int,
[1m[94m239 |[0m         offset: int,
[1m[94m240 |[0m     ) -> List[Dict[str, Any]]:
    [1m[94m|[0m          [1m[91m^^^^[0m
[1m[94m241 |[0m         """Láº¥y danh sÃ¡ch tá»« Redis"""
[1m[94m242 |[0m         entries = []
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:240:15
    [1m[94m|[0m
[1m[94m238 |[0m         limit: int,
[1m[94m239 |[0m         offset: int,
[1m[94m240 |[0m     ) -> List[Dict[str, Any]]:
    [1m[94m|[0m               [1m[91m^^^^[0m
[1m[94m241 |[0m         """Láº¥y danh sÃ¡ch tá»« Redis"""
[1m[94m242 |[0m         entries = []
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:248:1
    [1m[94m|[0m
[1m[94m246 |[0m                 "dlq:index", offset, offset + limit - 1
[1m[94m247 |[0m             )
[1m[94m248 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m249 |[0m             for task_id_bytes in task_ids:
[1m[94m250 |[0m                 task_id = task_id_bytes.decode('utf-8')
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:255:1
    [1m[94m|[0m
[1m[94m253 |[0m                     if task_type is None or entry.get("task_type") == task_type:
[1m[94m254 |[0m                         entries.append(entry)
[1m[94m255 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m256 |[0m             return entries
[1m[94m257 |[0m         except Exception:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:259:1
    [1m[94m|[0m
[1m[94m257 |[0m         except Exception:
[1m[94m258 |[0m             return []
[1m[94m259 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m260 |[0m     def _count(self) -> int:
[1m[94m261 |[0m         """Äáº¿m sá»‘ entries"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:272:1
    [1m[94m|[0m
[1m[94m270 |[0m             except Exception:
[1m[94m271 |[0m                 return 0
[1m[94m272 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m273 |[0m     def _remove_oldest(self, count: int) -> int:
[1m[94m274 |[0m         """XÃ³a cÃ¡c entries cÅ© nháº¥t"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:298:1
    [1m[94m|[0m
[1m[94m296 |[0m                 pass
[1m[94m297 |[0m         return removed
[1m[94m298 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m299 |[0m     def get_stats(self) -> Dict[str, Any]:
[1m[94m300 |[0m         """Láº¥y thá»‘ng kÃª DLQ"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:299:28
    [1m[94m|[0m
[1m[94m297 |[0m         return removed
[1m[94m298 |[0m     
[1m[94m299 |[0m     def get_stats(self) -> Dict[str, Any]:
    [1m[94m|[0m                            [1m[91m^^^^[0m
[1m[94m300 |[0m         """Láº¥y thá»‘ng kÃª DLQ"""
[1m[94m301 |[0m         entries = self.list_all(limit=10000)  # Láº¥y táº¥t cáº£ Ä‘á»ƒ thá»‘ng kÃª
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:302:1
    [1m[94m|[0m
[1m[94m300 |[0m         """Láº¥y thá»‘ng kÃª DLQ"""
[1m[94m301 |[0m         entries = self.list_all(limit=10000)  # Láº¥y táº¥t cáº£ Ä‘á»ƒ thá»‘ng kÃª
[1m[94m302 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m303 |[0m         stats = {
[1m[94m304 |[0m             "total": len(entries),
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:310:1
    [1m[94m|[0m
[1m[94m308 |[0m             "newest": None,
[1m[94m309 |[0m         }
[1m[94m310 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m311 |[0m         if entries:
[1m[94m312 |[0m             # Thá»‘ng kÃª theo task type
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:316:1
    [1m[94m|[0m
[1m[94m314 |[0m                 task_type = entry.get("task_type", "unknown")
[1m[94m315 |[0m                 stats["by_task_type"][task_type] = stats["by_task_type"].get(task_type, 0) + 1
[1m[94m316 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m317 |[0m                 error_type = entry.get("error_type", "unknown")
[1m[94m318 |[0m                 stats["by_error_type"][error_type] = stats["by_error_type"].get(error_type, 0) + 1
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:319:1
    [1m[94m|[0m
[1m[94m317 |[0m                 error_type = entry.get("error_type", "unknown")
[1m[94m318 |[0m                 stats["by_error_type"][error_type] = stats["by_error_type"].get(error_type, 0) + 1
[1m[94m319 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m320 |[0m             # Oldest vÃ  newest
[1m[94m321 |[0m             sorted_entries = sorted(entries, key=lambda x: x.get("timestamp", 0))
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:324:1
    [1m[94m|[0m
[1m[94m322 |[0m             stats["oldest"] = sorted_entries[0].get("failed_at")
[1m[94m323 |[0m             stats["newest"] = sorted_entries[-1].get("failed_at")
[1m[94m324 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m325 |[0m         return stats
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:329:16
    [1m[94m|[0m
[1m[94m328 |[0m # Singleton instance
[1m[94m329 |[0m _dlq_instance: Optional[DeadLetterQueue] = None
    [1m[94m|[0m                [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^[0m
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:334:19
    [1m[94m|[0m
[1m[94m332 |[0m def get_dlq(
[1m[94m333 |[0m     storage_type: str = "file",
[1m[94m334 |[0m     storage_path: Optional[str | Path] = None,
    [1m[94m|[0m                   [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m335 |[0m     redis_url: Optional[str] = None,
[1m[94m336 |[0m ) -> DeadLetterQueue:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:335:16
    [1m[94m|[0m
[1m[94m333 |[0m     storage_type: str = "file",
[1m[94m334 |[0m     storage_path: Optional[str | Path] = None,
[1m[94m335 |[0m     redis_url: Optional[str] = None,
    [1m[94m|[0m                [1m[91m^^^^^^^^^^^^^[0m
[1m[94m336 |[0m ) -> DeadLetterQueue:
[1m[94m337 |[0m     """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:339:1
    [1m[94m|[0m
[1m[94m337 |[0m     """
[1m[94m338 |[0m     Láº¥y DLQ instance (singleton)
[1m[94m339 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m340 |[0m     Args:
[1m[94m341 |[0m         storage_type: "file" hoáº·c "redis"
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:344:1
    [1m[94m|[0m
[1m[94m342 |[0m         storage_path: ÄÆ°á»ng dáº«n file storage
[1m[94m343 |[0m         redis_url: Redis URL
[1m[94m344 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m345 |[0m     Returns:
[1m[94m346 |[0m         DeadLetterQueue instance
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:349:1
    [1m[94m|[0m
[1m[94m347 |[0m     """
[1m[94m348 |[0m     global _dlq_instance
[1m[94m349 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m350 |[0m     if _dlq_instance is None:
[1m[94m351 |[0m         _dlq_instance = DeadLetterQueue(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\dead_letter_queue.py:356:1
    [1m[94m|[0m
[1m[94m354 |[0m             redis_url=redis_url,
[1m[94m355 |[0m         )
[1m[94m356 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m357 |[0m     return _dlq_instance
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP035 [0m[[1m[96m*[0m] [1mImport from `collections.abc` instead: `Callable`[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:5:1
  [1m[94m|[0m
[1m[94m3 |[0m """
[1m[94m4 |[0m
[1m[94m5 |[0m from typing import Any, Callable, Optional, TypeVar, Dict
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m6 |[0m from functools import wraps
[1m[94m7 |[0m import uuid
  [1m[94m|[0m
[1m[96mhelp[0m: [1mImport from `collections.abc`[0m

[1m[91mUP035 [0m[1m`typing.Dict` is deprecated, use `dict` instead[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:5:1
  [1m[94m|[0m
[1m[94m3 |[0m """
[1m[94m4 |[0m
[1m[94m5 |[0m from typing import Any, Callable, Optional, TypeVar, Dict
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m6 |[0m from functools import wraps
[1m[94m7 |[0m import uuid
  [1m[94m|[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:5:1
   [1m[94m|[0m
[1m[94m 3 |[0m   """
[1m[94m 4 |[0m
[1m[94m 5 |[0m [1m[91m/[0m from typing import Any, Callable, Optional, TypeVar, Dict
[1m[94m 6 |[0m [1m[91m|[0m from functools import wraps
[1m[94m 7 |[0m [1m[91m|[0m import uuid
[1m[94m 8 |[0m [1m[91m|[0m
[1m[94m 9 |[0m [1m[91m|[0m from .exceptions import CrawlError, classify_error
[1m[94m10 |[0m [1m[91m|[0m from .circuit_breaker import CircuitBreaker, CircuitBreakerOpenError
[1m[94m11 |[0m [1m[91m|[0m from .dead_letter_queue import get_dlq, DeadLetterQueue
[1m[94m12 |[0m [1m[91m|[0m from .graceful_degradation import get_service_health, GracefulDegradation
   [1m[94m|[0m [1m[91m|_________________________________________________________________________^[0m
[1m[94m13 |[0m
[1m[94m14 |[0m   T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`.graceful_degradation.get_service_health` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:12:35
   [1m[94m|[0m
[1m[94m10 |[0m from .circuit_breaker import CircuitBreaker, CircuitBreakerOpenError
[1m[94m11 |[0m from .dead_letter_queue import get_dlq, DeadLetterQueue
[1m[94m12 |[0m from .graceful_degradation import get_service_health, GracefulDegradation
   [1m[94m|[0m                                   [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m13 |[0m
[1m[94m14 |[0m T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import: `.graceful_degradation.get_service_health`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:25:1
   [1m[94m|[0m
[1m[94m23 |[0m     - Graceful degradation
[1m[94m24 |[0m     """
[1m[94m25 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m26 |[0m     def __init__(
[1m[94m27 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:29:26
   [1m[94m|[0m
[1m[94m27 |[0m         self,
[1m[94m28 |[0m         task_type: str,
[1m[94m29 |[0m         circuit_breaker: Optional[CircuitBreaker] = None,
   [1m[94m|[0m                          [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m30 |[0m         dlq: Optional[DeadLetterQueue] = None,
[1m[94m31 |[0m         degradation: Optional[GracefulDegradation] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:30:14
   [1m[94m|[0m
[1m[94m28 |[0m         task_type: str,
[1m[94m29 |[0m         circuit_breaker: Optional[CircuitBreaker] = None,
[1m[94m30 |[0m         dlq: Optional[DeadLetterQueue] = None,
   [1m[94m|[0m              [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m31 |[0m         degradation: Optional[GracefulDegradation] = None,
[1m[94m32 |[0m         max_retries: int = 3,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:31:22
   [1m[94m|[0m
[1m[94m29 |[0m         circuit_breaker: Optional[CircuitBreaker] = None,
[1m[94m30 |[0m         dlq: Optional[DeadLetterQueue] = None,
[1m[94m31 |[0m         degradation: Optional[GracefulDegradation] = None,
   [1m[94m|[0m                      [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m32 |[0m         max_retries: int = 3,
[1m[94m33 |[0m         retry_delay: float = 1.0,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:50:1
   [1m[94m|[0m
[1m[94m48 |[0m         self.max_retries = max_retries
[1m[94m49 |[0m         self.retry_delay = retry_delay
[1m[94m50 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m51 |[0m     def handle(
[1m[94m52 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:55:18
   [1m[94m|[0m
[1m[94m53 |[0m         func: Callable[..., T],
[1m[94m54 |[0m         *args,
[1m[94m55 |[0m         task_id: Optional[str] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^[0m
[1m[94m56 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m57 |[0m         **kwargs,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:56:18
   [1m[94m|[0m
[1m[94m54 |[0m         *args,
[1m[94m55 |[0m         task_id: Optional[str] = None,
[1m[94m56 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m57 |[0m         **kwargs,
[1m[94m58 |[0m     ) -> Optional[T]:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:56:27
   [1m[94m|[0m
[1m[94m54 |[0m         *args,
[1m[94m55 |[0m         task_id: Optional[str] = None,
[1m[94m56 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m57 |[0m         **kwargs,
[1m[94m58 |[0m     ) -> Optional[T]:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:58:10
   [1m[94m|[0m
[1m[94m56 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m57 |[0m         **kwargs,
[1m[94m58 |[0m     ) -> Optional[T]:
   [1m[94m|[0m          [1m[91m^^^^^^^^^^^[0m
[1m[94m59 |[0m         """
[1m[94m60 |[0m         Xá»­ lÃ½ function call vá»›i error handling Ä‘áº§y Ä‘á»§
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:61:1
   [1m[94m|[0m
[1m[94m59 |[0m         """
[1m[94m60 |[0m         Xá»­ lÃ½ function call vá»›i error handling Ä‘áº§y Ä‘á»§
[1m[94m61 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m62 |[0m         Args:
[1m[94m63 |[0m             func: Function cáº§n gá»i
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:67:1
   [1m[94m|[0m
[1m[94m65 |[0m             task_id: ID cá»§a task (tá»± Ä‘á»™ng generate náº¿u None)
[1m[94m66 |[0m             context: Context thÃªm
[1m[94m67 |[0m             
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m68 |[0m         Returns:
[1m[94m69 |[0m             Káº¿t quáº£ tá»« function hoáº·c None náº¿u failed
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:73:1
   [1m[94m|[0m
[1m[94m71 |[0m         if task_id is None:
[1m[94m72 |[0m             task_id = str(uuid.uuid4())
[1m[94m73 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m74 |[0m         context = context or {}
[1m[94m75 |[0m         retry_count = 0
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:76:1
   [1m[94m|[0m
[1m[94m74 |[0m         context = context or {}
[1m[94m75 |[0m         retry_count = 0
[1m[94m76 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m77 |[0m         # Kiá»ƒm tra graceful degradation
[1m[94m78 |[0m         if self.degradation and self.degradation.should_skip():
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:81:1
   [1m[94m|[0m
[1m[94m79 |[0m             # Service Ä‘ang failed, skip
[1m[94m80 |[0m             return None
[1m[94m81 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m82 |[0m         while retry_count < self.max_retries:
[1m[94m83 |[0m             try:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:89:1
   [1m[94m|[0m
[1m[94m87 |[0m                 else:
[1m[94m88 |[0m                     result = func(*args, **kwargs)
[1m[94m89 |[0m                 
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m90 |[0m                 # Success
[1m[94m91 |[0m                 if self.degradation:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:93:1
   [1m[94m|[0m
[1m[94m91 |[0m                 if self.degradation:
[1m[94m92 |[0m                     self.degradation.record_success()
[1m[94m93 |[0m                 
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m94 |[0m                 return result
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:95:1
   [1m[94m|[0m
[1m[94m94 |[0m                 return result
[1m[94m95 |[0m                 
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m96 |[0m             except CircuitBreakerOpenError as e:
[1m[94m97 |[0m                 # Circuit breaker Ä‘ang má»Ÿ
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:101:1
    [1m[94m|[0m
[1m[94m 99 |[0m                 self._add_to_dlq(task_id, crawl_error, context, retry_count)
[1m[94m100 |[0m                 return None
[1m[94m101 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m102 |[0m             except Exception as e:
[1m[94m103 |[0m                 # PhÃ¢n loáº¡i error
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:105:1
    [1m[94m|[0m
[1m[94m103 |[0m                 # PhÃ¢n loáº¡i error
[1m[94m104 |[0m                 crawl_error = classify_error(e, context=context)
[1m[94m105 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m106 |[0m                 # Ghi nháº­n failure
[1m[94m107 |[0m                 if self.degradation:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:109:1
    [1m[94m|[0m
[1m[94m107 |[0m                 if self.degradation:
[1m[94m108 |[0m                     self.degradation.record_failure()
[1m[94m109 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m110 |[0m                 retry_count += 1
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:111:1
    [1m[94m|[0m
[1m[94m110 |[0m                 retry_count += 1
[1m[94m111 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m112 |[0m                 # Náº¿u Ä‘Ã£ háº¿t retries, thÃªm vÃ o DLQ
[1m[94m113 |[0m                 if retry_count >= self.max_retries:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:116:1
    [1m[94m|[0m
[1m[94m114 |[0m                     self._add_to_dlq(task_id, crawl_error, context, retry_count)
[1m[94m115 |[0m                     return None
[1m[94m116 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m117 |[0m                 # Retry vá»›i delay
[1m[94m118 |[0m                 import time
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:120:1
    [1m[94m|[0m
[1m[94m118 |[0m                 import time
[1m[94m119 |[0m                 time.sleep(self.retry_delay * retry_count)  # Exponential backoff
[1m[94m120 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m121 |[0m         return None
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:122:1
    [1m[94m|[0m
[1m[94m121 |[0m         return None
[1m[94m122 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m123 |[0m     def _add_to_dlq(
[1m[94m124 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:127:18
    [1m[94m|[0m
[1m[94m125 |[0m         task_id: str,
[1m[94m126 |[0m         error: CrawlError,
[1m[94m127 |[0m         context: Dict[str, Any],
    [1m[94m|[0m                  [1m[91m^^^^[0m
[1m[94m128 |[0m         retry_count: int,
[1m[94m129 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:146:22
    [1m[94m|[0m
[1m[94m144 |[0m def with_error_handling(
[1m[94m145 |[0m     task_type: str,
[1m[94m146 |[0m     circuit_breaker: Optional[CircuitBreaker] = None,
    [1m[94m|[0m                      [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m147 |[0m     dlq: Optional[DeadLetterQueue] = None,
[1m[94m148 |[0m     degradation: Optional[GracefulDegradation] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:147:10
    [1m[94m|[0m
[1m[94m145 |[0m     task_type: str,
[1m[94m146 |[0m     circuit_breaker: Optional[CircuitBreaker] = None,
[1m[94m147 |[0m     dlq: Optional[DeadLetterQueue] = None,
    [1m[94m|[0m          [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m148 |[0m     degradation: Optional[GracefulDegradation] = None,
[1m[94m149 |[0m     max_retries: int = 3,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:148:18
    [1m[94m|[0m
[1m[94m146 |[0m     circuit_breaker: Optional[CircuitBreaker] = None,
[1m[94m147 |[0m     dlq: Optional[DeadLetterQueue] = None,
[1m[94m148 |[0m     degradation: Optional[GracefulDegradation] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m149 |[0m     max_retries: int = 3,
[1m[94m150 |[0m     retry_delay: float = 1.0,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:154:1
    [1m[94m|[0m
[1m[94m152 |[0m     """
[1m[94m153 |[0m     Decorator Ä‘á»ƒ Ã¡p dá»¥ng error handling cho function
[1m[94m154 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m155 |[0m     Args:
[1m[94m156 |[0m         task_type: Loáº¡i task
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:162:1
    [1m[94m|[0m
[1m[94m160 |[0m         max_retries: Sá»‘ láº§n retry
[1m[94m161 |[0m         retry_delay: Delay giá»¯a retries
[1m[94m162 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m163 |[0m     Example:
[1m[94m164 |[0m         @with_error_handling(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:180:1
    [1m[94m|[0m
[1m[94m178 |[0m             retry_delay=retry_delay,
[1m[94m179 |[0m         )
[1m[94m180 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m181 |[0m         @wraps(func)
[1m[94m182 |[0m         def wrapper(*args, **kwargs) -> Optional[T]:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:182:41
    [1m[94m|[0m
[1m[94m181 |[0m         @wraps(func)
[1m[94m182 |[0m         def wrapper(*args, **kwargs) -> Optional[T]:
    [1m[94m|[0m                                         [1m[91m^^^^^^^^^^^[0m
[1m[94m183 |[0m             return handler.handle(func, *args, **kwargs)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:184:1
    [1m[94m|[0m
[1m[94m182 |[0m         def wrapper(*args, **kwargs) -> Optional[T]:
[1m[94m183 |[0m             return handler.handle(func, *args, **kwargs)
[1m[94m184 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m185 |[0m         return wrapper
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handler.py:186:1
    [1m[94m|[0m
[1m[94m185 |[0m         return wrapper
[1m[94m186 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m187 |[0m     return decorator
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:7:1
   [1m[94m|[0m
[1m[94m 5 |[0m   """
[1m[94m 6 |[0m
[1m[94m 7 |[0m [1m[91m/[0m from . import (
[1m[94m 8 |[0m [1m[91m|[0m     NetworkError,
[1m[94m 9 |[0m [1m[91m|[0m     ParseError,
[1m[94m10 |[0m [1m[91m|[0m     CircuitBreaker,
[1m[94m11 |[0m [1m[91m|[0m     get_dlq,
[1m[94m12 |[0m [1m[91m|[0m     get_service_health,
[1m[94m13 |[0m [1m[91m|[0m     with_error_handling,
[1m[94m14 |[0m [1m[91m|[0m     circuit_breaker,
[1m[94m15 |[0m [1m[91m|[0m )
   [1m[94m|[0m [1m[91m|_^[0m
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`.NetworkError` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:8:5
   [1m[94m|[0m
[1m[94m 7 |[0m from . import (
[1m[94m 8 |[0m     NetworkError,
   [1m[94m|[0m     [1m[91m^^^^^^^^^^^^[0m
[1m[94m 9 |[0m     ParseError,
[1m[94m10 |[0m     CircuitBreaker,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`.ParseError` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:9:5
   [1m[94m|[0m
[1m[94m 7 |[0m from . import (
[1m[94m 8 |[0m     NetworkError,
[1m[94m 9 |[0m     ParseError,
   [1m[94m|[0m     [1m[91m^^^^^^^^^^[0m
[1m[94m10 |[0m     CircuitBreaker,
[1m[94m11 |[0m     get_dlq,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`.CircuitBreaker` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:10:5
   [1m[94m|[0m
[1m[94m 8 |[0m     NetworkError,
[1m[94m 9 |[0m     ParseError,
[1m[94m10 |[0m     CircuitBreaker,
   [1m[94m|[0m     [1m[91m^^^^^^^^^^^^^^[0m
[1m[94m11 |[0m     get_dlq,
[1m[94m12 |[0m     get_service_health,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`.get_service_health` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:12:5
   [1m[94m|[0m
[1m[94m10 |[0m     CircuitBreaker,
[1m[94m11 |[0m     get_dlq,
[1m[94m12 |[0m     get_service_health,
   [1m[94m|[0m     [1m[91m^^^^^^^^^^^^^^^^^^[0m
[1m[94m13 |[0m     with_error_handling,
[1m[94m14 |[0m     circuit_breaker,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:40:1
   [1m[94m|[0m
[1m[94m38 |[0m     # - ThÃªm vÃ o DLQ náº¿u fail sau retries
[1m[94m39 |[0m     # - Ghi nháº­n success/failure cho graceful degradation
[1m[94m40 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m41 |[0m     import requests
[1m[94m42 |[0m     response = requests.get(category_url, timeout=30)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:50:5
   [1m[94m|[0m
[1m[94m48 |[0m def crawl_product_manual(product_url: str):
[1m[94m49 |[0m     """Crawl product vá»›i manual error handling"""
[1m[94m50 |[0m     from . import ErrorHandler, CircuitBreaker
   [1m[94m|[0m     [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m51 |[0m     
[1m[94m52 |[0m     # Táº¡o circuit breaker cho Tiki API
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF811 [0m[[1m[96m*[0m] [1mRedefinition of unused `CircuitBreaker` from line 10[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:50:33
   [1m[94m|[0m
[1m[94m48 |[0m def crawl_product_manual(product_url: str):
[1m[94m49 |[0m     """Crawl product vá»›i manual error handling"""
[1m[94m50 |[0m     from . import ErrorHandler, CircuitBreaker
   [1m[94m|[0m                                 [1m[91m^^^^^^^^^^^^^^[0m [1m[91m`CircuitBreaker` redefined here[0m
[1m[94m51 |[0m     
[1m[94m52 |[0m     # Táº¡o circuit breaker cho Tiki API
   [1m[94m|[0m
  [1m[94m:::[0m src\pipelines\crawl\resilience\error_handling_example.py:10:5
   [1m[94m|[0m
[1m[94m 8 |[0m     NetworkError,
[1m[94m 9 |[0m     ParseError,
[1m[94m10 |[0m     CircuitBreaker,
   [1m[94m|[0m     [1m[33m--------------[0m [1m[33mprevious definition of `CircuitBreaker` here[0m
[1m[94m11 |[0m     get_dlq,
[1m[94m12 |[0m     get_service_health,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove definition: `CircuitBreaker`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:51:1
   [1m[94m|[0m
[1m[94m49 |[0m     """Crawl product vá»›i manual error handling"""
[1m[94m50 |[0m     from . import ErrorHandler, CircuitBreaker
[1m[94m51 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m52 |[0m     # Táº¡o circuit breaker cho Tiki API
[1m[94m53 |[0m     cb = CircuitBreaker(
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:58:1
   [1m[94m|[0m
[1m[94m56 |[0m         name="tiki_api",
[1m[94m57 |[0m     )
[1m[94m58 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m59 |[0m     # Táº¡o error handler
[1m[94m60 |[0m     handler = ErrorHandler(
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:65:1
   [1m[94m|[0m
[1m[94m63 |[0m         max_retries=3,
[1m[94m64 |[0m     )
[1m[94m65 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m66 |[0m     def _fetch_product():
[1m[94m67 |[0m         import requests
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:71:1
   [1m[94m|[0m
[1m[94m69 |[0m         response.raise_for_status()
[1m[94m70 |[0m         return response.text
[1m[94m71 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m72 |[0m     # Gá»i vá»›i error handling
[1m[94m73 |[0m     result = handler.handle(
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:78:1
   [1m[94m|[0m
[1m[94m76 |[0m         context={"url": product_url},
[1m[94m77 |[0m     )
[1m[94m78 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m79 |[0m     return result
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mF811 [0m[[1m[96m*[0m] [1mRedefinition of unused `get_service_health` from line 12[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:85:19
   [1m[94m|[0m
[1m[94m83 |[0m def crawl_with_graceful_degradation():
[1m[94m84 |[0m     """Crawl vá»›i graceful degradation"""
[1m[94m85 |[0m     from . import get_service_health
   [1m[94m|[0m                   [1m[91m^^^^^^^^^^^^^^^^^^[0m [1m[91m`get_service_health` redefined here[0m
[1m[94m86 |[0m     
[1m[94m87 |[0m     service_health = get_service_health()
   [1m[94m|[0m
  [1m[94m:::[0m src\pipelines\crawl\resilience\error_handling_example.py:12:5
   [1m[94m|[0m
[1m[94m10 |[0m     CircuitBreaker,
[1m[94m11 |[0m     get_dlq,
[1m[94m12 |[0m     get_service_health,
   [1m[94m|[0m     [1m[33m------------------[0m [1m[33mprevious definition of `get_service_health` here[0m
[1m[94m13 |[0m     with_error_handling,
[1m[94m14 |[0m     circuit_breaker,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove definition: `get_service_health`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:86:1
   [1m[94m|[0m
[1m[94m84 |[0m     """Crawl vá»›i graceful degradation"""
[1m[94m85 |[0m     from . import get_service_health
[1m[94m86 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m87 |[0m     service_health = get_service_health()
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:88:1
   [1m[94m|[0m
[1m[94m87 |[0m     service_health = get_service_health()
[1m[94m88 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m89 |[0m     # ÄÄƒng kÃ½ service
[1m[94m90 |[0m     tiki_service = service_health.register_service(
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:95:1
   [1m[94m|[0m
[1m[94m93 |[0m         recovery_threshold=5,
[1m[94m94 |[0m     )
[1m[94m95 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m96 |[0m     # Callback khi service degrade
[1m[94m97 |[0m     def on_degrade(old_level, new_level):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:99:1
    [1m[94m|[0m
[1m[94m 97 |[0m     def on_degrade(old_level, new_level):
[1m[94m 98 |[0m         print(f"Service degraded: {old_level} -> {new_level}")
[1m[94m 99 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m100 |[0m     tiki_service.register_callback("reduced", on_degrade)
[1m[94m101 |[0m     tiki_service.register_callback("minimal", on_degrade)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:103:1
    [1m[94m|[0m
[1m[94m101 |[0m     tiki_service.register_callback("minimal", on_degrade)
[1m[94m102 |[0m     tiki_service.register_callback("failed", on_degrade)
[1m[94m103 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m104 |[0m     # Sá»­ dá»¥ng trong crawl
[1m[94m105 |[0m     try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mF841 [0m[[1m[96m*[0m] [1mLocal variable `e` is assigned to but never used[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:110:25
    [1m[94m|[0m
[1m[94m108 |[0m         tiki_service.record_success()
[1m[94m109 |[0m         return response.text
[1m[94m110 |[0m     except Exception as e:
    [1m[94m|[0m                         [1m[91m^[0m
[1m[94m111 |[0m         tiki_service.record_failure()
[1m[94m112 |[0m         raise
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove assignment to unused variable `e`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:119:1
    [1m[94m|[0m
[1m[94m117 |[0m     """Retry cÃ¡c tasks Ä‘Ã£ fail tá»« DLQ"""
[1m[94m118 |[0m     dlq = get_dlq()
[1m[94m119 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m120 |[0m     # Láº¥y táº¥t cáº£ failed tasks
[1m[94m121 |[0m     failed_tasks = dlq.list_all(limit=100)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:122:1
    [1m[94m|[0m
[1m[94m120 |[0m     # Láº¥y táº¥t cáº£ failed tasks
[1m[94m121 |[0m     failed_tasks = dlq.list_all(limit=100)
[1m[94m122 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m123 |[0m     for task in failed_tasks:
[1m[94m124 |[0m         task_id = task["task_id"]
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:127:1
    [1m[94m|[0m
[1m[94m125 |[0m         task_type = task["task_type"]
[1m[94m126 |[0m         context = task.get("context", {})
[1m[94m127 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m128 |[0m         print(f"Retrying task {task_id} ({task_type})")
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:129:1
    [1m[94m|[0m
[1m[94m128 |[0m         print(f"Retrying task {task_id} ({task_type})")
[1m[94m129 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m130 |[0m         # Retry logic
[1m[94m131 |[0m         try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:138:1
    [1m[94m|[0m
[1m[94m136 |[0m                     # crawl_category_with_error_handling(url)
[1m[94m137 |[0m                     pass
[1m[94m138 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m139 |[0m             # Náº¿u thÃ nh cÃ´ng, xÃ³a khá»i DLQ
[1m[94m140 |[0m             dlq.remove(task_id)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:142:1
    [1m[94m|[0m
[1m[94m140 |[0m             dlq.remove(task_id)
[1m[94m141 |[0m             print(f"âœ… Task {task_id} retried successfully")
[1m[94m142 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m143 |[0m         except Exception as e:
[1m[94m144 |[0m             print(f"âŒ Task {task_id} still failed: {e}")
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:155:1
    [1m[94m|[0m
[1m[94m153 |[0m     """
[1m[94m154 |[0m     Enhanced version cá»§a crawl_category_products vá»›i error handling
[1m[94m155 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m156 |[0m     Args:
[1m[94m157 |[0m         category_url: URL cá»§a category
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:165:1
    [1m[94m|[0m
[1m[94m163 |[0m         from ..crawl_products import crawl_category_products
[1m[94m164 |[0m         return crawl_category_products(category_url, max_pages=max_pages)
[1m[94m165 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m166 |[0m     # Sá»­ dá»¥ng error handling
[1m[94m167 |[0m     from . import ErrorHandler, CircuitBreaker
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:167:5
    [1m[94m|[0m
[1m[94m166 |[0m     # Sá»­ dá»¥ng error handling
[1m[94m167 |[0m     from . import ErrorHandler, CircuitBreaker
    [1m[94m|[0m     [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m168 |[0m     
[1m[94m169 |[0m     cb = CircuitBreaker(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF811 [0m[[1m[96m*[0m] [1mRedefinition of unused `CircuitBreaker` from line 10[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:167:33
    [1m[94m|[0m
[1m[94m166 |[0m     # Sá»­ dá»¥ng error handling
[1m[94m167 |[0m     from . import ErrorHandler, CircuitBreaker
    [1m[94m|[0m                                 [1m[91m^^^^^^^^^^^^^^[0m [1m[91m`CircuitBreaker` redefined here[0m
[1m[94m168 |[0m     
[1m[94m169 |[0m     cb = CircuitBreaker(
    [1m[94m|[0m
   [1m[94m:::[0m src\pipelines\crawl\resilience\error_handling_example.py:10:5
    [1m[94m|[0m
[1m[94m  8 |[0m     NetworkError,
[1m[94m  9 |[0m     ParseError,
[1m[94m 10 |[0m     CircuitBreaker,
    [1m[94m|[0m     [1m[33m--------------[0m [1m[33mprevious definition of `CircuitBreaker` here[0m
[1m[94m 11 |[0m     get_dlq,
[1m[94m 12 |[0m     get_service_health,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove definition: `CircuitBreaker`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:168:1
    [1m[94m|[0m
[1m[94m166 |[0m     # Sá»­ dá»¥ng error handling
[1m[94m167 |[0m     from . import ErrorHandler, CircuitBreaker
[1m[94m168 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m169 |[0m     cb = CircuitBreaker(
[1m[94m170 |[0m         failure_threshold=5,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:174:1
    [1m[94m|[0m
[1m[94m172 |[0m         name="tiki_crawl",
[1m[94m173 |[0m     )
[1m[94m174 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m175 |[0m     handler = ErrorHandler(
[1m[94m176 |[0m         task_type="crawl_category",
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:180:1
    [1m[94m|[0m
[1m[94m178 |[0m         max_retries=2,
[1m[94m179 |[0m     )
[1m[94m180 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m181 |[0m     def _crawl():
[1m[94m182 |[0m         from ..crawl_products import crawl_category_products
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:184:1
    [1m[94m|[0m
[1m[94m182 |[0m         from ..crawl_products import crawl_category_products
[1m[94m183 |[0m         return crawl_category_products(category_url, max_pages=max_pages)
[1m[94m184 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m185 |[0m     result = handler.handle(
[1m[94m186 |[0m         _crawl,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\error_handling_example.py:190:1
    [1m[94m|[0m
[1m[94m188 |[0m         context={"url": category_url, "max_pages": max_pages},
[1m[94m189 |[0m     )
[1m[94m190 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m191 |[0m     return result or []  # Return empty list náº¿u fail
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP035 [0m[1m`typing.Dict` is deprecated, use `dict` instead[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:6:1
  [1m[94m|[0m
[1m[94m4 |[0m """
[1m[94m5 |[0m
[1m[94m6 |[0m from typing import Optional, Dict, Any
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
  [1m[94m|[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:6:1
  [1m[94m|[0m
[1m[94m4 |[0m """
[1m[94m5 |[0m
[1m[94m6 |[0m from typing import Optional, Dict, Any
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
  [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:11:1
   [1m[94m|[0m
[1m[94m 9 |[0m class CrawlError(Exception):
[1m[94m10 |[0m     """Base exception cho táº¥t cáº£ cÃ¡c lá»—i crawl"""
[1m[94m11 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m12 |[0m     def __init__(
[1m[94m13 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:15:18
   [1m[94m|[0m
[1m[94m13 |[0m         self,
[1m[94m14 |[0m         message: str,
[1m[94m15 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m16 |[0m         original_error: Optional[Exception] = None,
[1m[94m17 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:15:27
   [1m[94m|[0m
[1m[94m13 |[0m         self,
[1m[94m14 |[0m         message: str,
[1m[94m15 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m16 |[0m         original_error: Optional[Exception] = None,
[1m[94m17 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:16:25
   [1m[94m|[0m
[1m[94m14 |[0m         message: str,
[1m[94m15 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m16 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m17 |[0m     ):
[1m[94m18 |[0m         """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:28:1
   [1m[94m|[0m
[1m[94m26 |[0m         self.context = context or {}
[1m[94m27 |[0m         self.original_error = original_error
[1m[94m28 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m29 |[0m     def __str__(self) -> str:
[1m[94m30 |[0m         base_msg = self.message
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:35:1
   [1m[94m|[0m
[1m[94m33 |[0m             return f"{base_msg} [{context_str}]"
[1m[94m34 |[0m         return base_msg
[1m[94m35 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m36 |[0m     def to_dict(self) -> Dict[str, Any]:
[1m[94m37 |[0m         """Convert exception thÃ nh dict Ä‘á»ƒ log/serialize"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:36:26
   [1m[94m|[0m
[1m[94m34 |[0m         return base_msg
[1m[94m35 |[0m     
[1m[94m36 |[0m     def to_dict(self) -> Dict[str, Any]:
   [1m[94m|[0m                          [1m[91m^^^^[0m
[1m[94m37 |[0m         """Convert exception thÃ nh dict Ä‘á»ƒ log/serialize"""
[1m[94m38 |[0m         return {
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:48:1
   [1m[94m|[0m
[1m[94m46 |[0m class NetworkError(CrawlError):
[1m[94m47 |[0m     """Lá»—i liÃªn quan Ä‘áº¿n network (timeout, connection, DNS, etc.)"""
[1m[94m48 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m49 |[0m     def __init__(
[1m[94m50 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:52:14
   [1m[94m|[0m
[1m[94m50 |[0m         self,
[1m[94m51 |[0m         message: str,
[1m[94m52 |[0m         url: Optional[str] = None,
   [1m[94m|[0m              [1m[91m^^^^^^^^^^^^^[0m
[1m[94m53 |[0m         status_code: Optional[int] = None,
[1m[94m54 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:53:22
   [1m[94m|[0m
[1m[94m51 |[0m         message: str,
[1m[94m52 |[0m         url: Optional[str] = None,
[1m[94m53 |[0m         status_code: Optional[int] = None,
   [1m[94m|[0m                      [1m[91m^^^^^^^^^^^^^[0m
[1m[94m54 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m55 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:54:18
   [1m[94m|[0m
[1m[94m52 |[0m         url: Optional[str] = None,
[1m[94m53 |[0m         status_code: Optional[int] = None,
[1m[94m54 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m55 |[0m         original_error: Optional[Exception] = None,
[1m[94m56 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:54:27
   [1m[94m|[0m
[1m[94m52 |[0m         url: Optional[str] = None,
[1m[94m53 |[0m         status_code: Optional[int] = None,
[1m[94m54 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m55 |[0m         original_error: Optional[Exception] = None,
[1m[94m56 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:55:25
   [1m[94m|[0m
[1m[94m53 |[0m         status_code: Optional[int] = None,
[1m[94m54 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m55 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m56 |[0m     ):
[1m[94m57 |[0m         context = context or {}
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:67:1
   [1m[94m|[0m
[1m[94m65 |[0m class ParseError(CrawlError):
[1m[94m66 |[0m     """Lá»—i khi parse HTML/JSON (missing data, invalid format, etc.)"""
[1m[94m67 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m68 |[0m     def __init__(
[1m[94m69 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:71:14
   [1m[94m|[0m
[1m[94m69 |[0m         self,
[1m[94m70 |[0m         message: str,
[1m[94m71 |[0m         url: Optional[str] = None,
   [1m[94m|[0m              [1m[91m^^^^^^^^^^^^^[0m
[1m[94m72 |[0m         element: Optional[str] = None,
[1m[94m73 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:72:18
   [1m[94m|[0m
[1m[94m70 |[0m         message: str,
[1m[94m71 |[0m         url: Optional[str] = None,
[1m[94m72 |[0m         element: Optional[str] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^[0m
[1m[94m73 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m74 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:73:18
   [1m[94m|[0m
[1m[94m71 |[0m         url: Optional[str] = None,
[1m[94m72 |[0m         element: Optional[str] = None,
[1m[94m73 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m74 |[0m         original_error: Optional[Exception] = None,
[1m[94m75 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:73:27
   [1m[94m|[0m
[1m[94m71 |[0m         url: Optional[str] = None,
[1m[94m72 |[0m         element: Optional[str] = None,
[1m[94m73 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m74 |[0m         original_error: Optional[Exception] = None,
[1m[94m75 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:74:25
   [1m[94m|[0m
[1m[94m72 |[0m         element: Optional[str] = None,
[1m[94m73 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m74 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m75 |[0m     ):
[1m[94m76 |[0m         context = context or {}
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:86:1
   [1m[94m|[0m
[1m[94m84 |[0m class StorageError(CrawlError):
[1m[94m85 |[0m     """Lá»—i khi lÆ°u/Ä‘á»c dá»¯ liá»‡u (database, file, cache, etc.)"""
[1m[94m86 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m87 |[0m     def __init__(
[1m[94m88 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:90:23
   [1m[94m|[0m
[1m[94m88 |[0m         self,
[1m[94m89 |[0m         message: str,
[1m[94m90 |[0m         storage_type: Optional[str] = None,
   [1m[94m|[0m                       [1m[91m^^^^^^^^^^^^^[0m
[1m[94m91 |[0m         operation: Optional[str] = None,
[1m[94m92 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:91:20
   [1m[94m|[0m
[1m[94m89 |[0m         message: str,
[1m[94m90 |[0m         storage_type: Optional[str] = None,
[1m[94m91 |[0m         operation: Optional[str] = None,
   [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m92 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m93 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:92:18
   [1m[94m|[0m
[1m[94m90 |[0m         storage_type: Optional[str] = None,
[1m[94m91 |[0m         operation: Optional[str] = None,
[1m[94m92 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m93 |[0m         original_error: Optional[Exception] = None,
[1m[94m94 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:92:27
   [1m[94m|[0m
[1m[94m90 |[0m         storage_type: Optional[str] = None,
[1m[94m91 |[0m         operation: Optional[str] = None,
[1m[94m92 |[0m         context: Optional[Dict[str, Any]] = None,
   [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m93 |[0m         original_error: Optional[Exception] = None,
[1m[94m94 |[0m     ):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:93:25
   [1m[94m|[0m
[1m[94m91 |[0m         operation: Optional[str] = None,
[1m[94m92 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m93 |[0m         original_error: Optional[Exception] = None,
   [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m94 |[0m     ):
[1m[94m95 |[0m         context = context or {}
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:105:1
    [1m[94m|[0m
[1m[94m103 |[0m class ValidationError(CrawlError):
[1m[94m104 |[0m     """Lá»—i validation dá»¯ liá»‡u (missing required fields, invalid format, etc.)"""
[1m[94m105 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m106 |[0m     def __init__(
[1m[94m107 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:109:16
    [1m[94m|[0m
[1m[94m107 |[0m         self,
[1m[94m108 |[0m         message: str,
[1m[94m109 |[0m         field: Optional[str] = None,
    [1m[94m|[0m                [1m[91m^^^^^^^^^^^^^[0m
[1m[94m110 |[0m         value: Optional[Any] = None,
[1m[94m111 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:110:16
    [1m[94m|[0m
[1m[94m108 |[0m         message: str,
[1m[94m109 |[0m         field: Optional[str] = None,
[1m[94m110 |[0m         value: Optional[Any] = None,
    [1m[94m|[0m                [1m[91m^^^^^^^^^^^^^[0m
[1m[94m111 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m112 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:111:18
    [1m[94m|[0m
[1m[94m109 |[0m         field: Optional[str] = None,
[1m[94m110 |[0m         value: Optional[Any] = None,
[1m[94m111 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m112 |[0m         original_error: Optional[Exception] = None,
[1m[94m113 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:111:27
    [1m[94m|[0m
[1m[94m109 |[0m         field: Optional[str] = None,
[1m[94m110 |[0m         value: Optional[Any] = None,
[1m[94m111 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m112 |[0m         original_error: Optional[Exception] = None,
[1m[94m113 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:112:25
    [1m[94m|[0m
[1m[94m110 |[0m         value: Optional[Any] = None,
[1m[94m111 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m112 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m113 |[0m     ):
[1m[94m114 |[0m         context = context or {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:124:1
    [1m[94m|[0m
[1m[94m122 |[0m class RateLimitError(CrawlError):
[1m[94m123 |[0m     """Lá»—i khi vÆ°á»£t quÃ¡ rate limit"""
[1m[94m124 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m125 |[0m     def __init__(
[1m[94m126 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:128:22
    [1m[94m|[0m
[1m[94m126 |[0m         self,
[1m[94m127 |[0m         message: str = "Rate limit exceeded",
[1m[94m128 |[0m         retry_after: Optional[int] = None,
    [1m[94m|[0m                      [1m[91m^^^^^^^^^^^^^[0m
[1m[94m129 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m130 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:129:18
    [1m[94m|[0m
[1m[94m127 |[0m         message: str = "Rate limit exceeded",
[1m[94m128 |[0m         retry_after: Optional[int] = None,
[1m[94m129 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m130 |[0m         original_error: Optional[Exception] = None,
[1m[94m131 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:129:27
    [1m[94m|[0m
[1m[94m127 |[0m         message: str = "Rate limit exceeded",
[1m[94m128 |[0m         retry_after: Optional[int] = None,
[1m[94m129 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m130 |[0m         original_error: Optional[Exception] = None,
[1m[94m131 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:130:25
    [1m[94m|[0m
[1m[94m128 |[0m         retry_after: Optional[int] = None,
[1m[94m129 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m130 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m131 |[0m     ):
[1m[94m132 |[0m         context = context or {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:140:1
    [1m[94m|[0m
[1m[94m138 |[0m class TimeoutError(CrawlError):
[1m[94m139 |[0m     """Lá»—i timeout (request timeout, operation timeout, etc.)"""
[1m[94m140 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m141 |[0m     def __init__(
[1m[94m142 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:144:18
    [1m[94m|[0m
[1m[94m142 |[0m         self,
[1m[94m143 |[0m         message: str,
[1m[94m144 |[0m         timeout: Optional[float] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m145 |[0m         operation: Optional[str] = None,
[1m[94m146 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:145:20
    [1m[94m|[0m
[1m[94m143 |[0m         message: str,
[1m[94m144 |[0m         timeout: Optional[float] = None,
[1m[94m145 |[0m         operation: Optional[str] = None,
    [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m146 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m147 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:146:18
    [1m[94m|[0m
[1m[94m144 |[0m         timeout: Optional[float] = None,
[1m[94m145 |[0m         operation: Optional[str] = None,
[1m[94m146 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m147 |[0m         original_error: Optional[Exception] = None,
[1m[94m148 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:146:27
    [1m[94m|[0m
[1m[94m144 |[0m         timeout: Optional[float] = None,
[1m[94m145 |[0m         operation: Optional[str] = None,
[1m[94m146 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m147 |[0m         original_error: Optional[Exception] = None,
[1m[94m148 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:147:25
    [1m[94m|[0m
[1m[94m145 |[0m         operation: Optional[str] = None,
[1m[94m146 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m147 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m148 |[0m     ):
[1m[94m149 |[0m         context = context or {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:159:1
    [1m[94m|[0m
[1m[94m157 |[0m class SeleniumError(CrawlError):
[1m[94m158 |[0m     """Lá»—i liÃªn quan Ä‘áº¿n Selenium (driver, browser, etc.)"""
[1m[94m159 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m160 |[0m     def __init__(
[1m[94m161 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:163:23
    [1m[94m|[0m
[1m[94m161 |[0m         self,
[1m[94m162 |[0m         message: str,
[1m[94m163 |[0m         driver_error: Optional[str] = None,
    [1m[94m|[0m                       [1m[91m^^^^^^^^^^^^^[0m
[1m[94m164 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m165 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:164:18
    [1m[94m|[0m
[1m[94m162 |[0m         message: str,
[1m[94m163 |[0m         driver_error: Optional[str] = None,
[1m[94m164 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m165 |[0m         original_error: Optional[Exception] = None,
[1m[94m166 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:164:27
    [1m[94m|[0m
[1m[94m162 |[0m         message: str,
[1m[94m163 |[0m         driver_error: Optional[str] = None,
[1m[94m164 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m165 |[0m         original_error: Optional[Exception] = None,
[1m[94m166 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:165:25
    [1m[94m|[0m
[1m[94m163 |[0m         driver_error: Optional[str] = None,
[1m[94m164 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m165 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m166 |[0m     ):
[1m[94m167 |[0m         context = context or {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:175:1
    [1m[94m|[0m
[1m[94m173 |[0m class ConfigurationError(CrawlError):
[1m[94m174 |[0m     """Lá»—i cáº¥u hÃ¬nh (missing config, invalid config, etc.)"""
[1m[94m175 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m176 |[0m     def __init__(
[1m[94m177 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:179:21
    [1m[94m|[0m
[1m[94m177 |[0m         self,
[1m[94m178 |[0m         message: str,
[1m[94m179 |[0m         config_key: Optional[str] = None,
    [1m[94m|[0m                     [1m[91m^^^^^^^^^^^^^[0m
[1m[94m180 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m181 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:180:18
    [1m[94m|[0m
[1m[94m178 |[0m         message: str,
[1m[94m179 |[0m         config_key: Optional[str] = None,
[1m[94m180 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                  [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m181 |[0m         original_error: Optional[Exception] = None,
[1m[94m182 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:180:27
    [1m[94m|[0m
[1m[94m178 |[0m         message: str,
[1m[94m179 |[0m         config_key: Optional[str] = None,
[1m[94m180 |[0m         context: Optional[Dict[str, Any]] = None,
    [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m181 |[0m         original_error: Optional[Exception] = None,
[1m[94m182 |[0m     ):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:181:25
    [1m[94m|[0m
[1m[94m179 |[0m         config_key: Optional[str] = None,
[1m[94m180 |[0m         context: Optional[Dict[str, Any]] = None,
[1m[94m181 |[0m         original_error: Optional[Exception] = None,
    [1m[94m|[0m                         [1m[91m^^^^^^^^^^^^^^^^^^^[0m
[1m[94m182 |[0m     ):
[1m[94m183 |[0m         context = context or {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:189:47
    [1m[94m|[0m
[1m[94m189 |[0m def classify_error(error: Exception, context: Optional[Dict[str, Any]] = None) -> CrawlError:
    [1m[94m|[0m                                               [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m190 |[0m     """
[1m[94m191 |[0m     PhÃ¢n loáº¡i generic exception thÃ nh custom exception
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:189:56
    [1m[94m|[0m
[1m[94m189 |[0m def classify_error(error: Exception, context: Optional[Dict[str, Any]] = None) -> CrawlError:
    [1m[94m|[0m                                                        [1m[91m^^^^[0m
[1m[94m190 |[0m     """
[1m[94m191 |[0m     PhÃ¢n loáº¡i generic exception thÃ nh custom exception
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:192:1
    [1m[94m|[0m
[1m[94m190 |[0m     """
[1m[94m191 |[0m     PhÃ¢n loáº¡i generic exception thÃ nh custom exception
[1m[94m192 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m193 |[0m     Args:
[1m[94m194 |[0m         error: Exception gá»‘c
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:196:1
    [1m[94m|[0m
[1m[94m194 |[0m         error: Exception gá»‘c
[1m[94m195 |[0m         context: Context thÃªm
[1m[94m196 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m197 |[0m     Returns:
[1m[94m198 |[0m         CrawlError instance
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:203:1
    [1m[94m|[0m
[1m[94m201 |[0m     error_msg = str(error)
[1m[94m202 |[0m     error_msg_lower = error_msg.lower()
[1m[94m203 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m204 |[0m     context = context or {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:205:1
    [1m[94m|[0m
[1m[94m204 |[0m     context = context or {}
[1m[94m205 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m206 |[0m     # Network errors
[1m[94m207 |[0m     if isinstance(error, (ConnectionError, TimeoutError)) or "connection" in error_msg_lower or "timeout" in error_msg_lower:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:219:1
    [1m[94m|[0m
[1m[94m217 |[0m             original_error=error,
[1m[94m218 |[0m         )
[1m[94m219 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m220 |[0m     # Rate limit
[1m[94m221 |[0m     if "rate limit" in error_msg_lower or "429" in error_msg:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:235:1
    [1m[94m|[0m
[1m[94m233 |[0m             original_error=error,
[1m[94m234 |[0m         )
[1m[94m235 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m236 |[0m     # Storage errors
[1m[94m237 |[0m     if "database" in error_msg_lower or "postgres" in error_msg_lower or "redis" in error_msg_lower:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:243:1
    [1m[94m|[0m
[1m[94m241 |[0m             original_error=error,
[1m[94m242 |[0m         )
[1m[94m243 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m244 |[0m     # Parse errors
[1m[94m245 |[0m     if "parse" in error_msg_lower or "json" in error_msg_lower or "html" in error_msg_lower:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:251:1
    [1m[94m|[0m
[1m[94m249 |[0m             original_error=error,
[1m[94m250 |[0m         )
[1m[94m251 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m252 |[0m     # Selenium errors
[1m[94m253 |[0m     if "selenium" in error_msg_lower or "webdriver" in error_msg_lower or "chrome" in error_msg_lower:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\exceptions.py:259:1
    [1m[94m|[0m
[1m[94m257 |[0m             original_error=error,
[1m[94m258 |[0m         )
[1m[94m259 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m260 |[0m     # Default: wrap as generic CrawlError
[1m[94m261 |[0m     return CrawlError(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP035 [0m[[1m[96m*[0m] [1mImport from `collections.abc` instead: `Callable`[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:6:1
  [1m[94m|[0m
[1m[94m4 |[0m """
[1m[94m5 |[0m
[1m[94m6 |[0m from typing import Any, Callable, Optional, TypeVar, Dict
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m7 |[0m from functools import wraps
[1m[94m8 |[0m import time
  [1m[94m|[0m
[1m[96mhelp[0m: [1mImport from `collections.abc`[0m

[1m[91mUP035 [0m[1m`typing.Dict` is deprecated, use `dict` instead[0m
 [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:6:1
  [1m[94m|[0m
[1m[94m4 |[0m """
[1m[94m5 |[0m
[1m[94m6 |[0m from typing import Any, Callable, Optional, TypeVar, Dict
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m7 |[0m from functools import wraps
[1m[94m8 |[0m import time
  [1m[94m|[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:6:1
   [1m[94m|[0m
[1m[94m 4 |[0m   """
[1m[94m 5 |[0m
[1m[94m 6 |[0m [1m[91m/[0m from typing import Any, Callable, Optional, TypeVar, Dict
[1m[94m 7 |[0m [1m[91m|[0m from functools import wraps
[1m[94m 8 |[0m [1m[91m|[0m import time
   [1m[94m|[0m [1m[91m|___________^[0m
[1m[94m 9 |[0m
[1m[94m10 |[0m   T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:26:1
   [1m[94m|[0m
[1m[94m24 |[0m     Tá»± Ä‘á»™ng giáº£m chá»©c nÄƒng khi cÃ³ lá»—i, tÄƒng láº¡i khi phá»¥c há»“i
[1m[94m25 |[0m     """
[1m[94m26 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m27 |[0m     def __init__(
[1m[94m28 |[0m         self,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:45:1
   [1m[94m|[0m
[1m[94m43 |[0m         self.recovery_threshold = recovery_threshold
[1m[94m44 |[0m         self.check_interval = check_interval
[1m[94m45 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m46 |[0m         self.current_level = DegradationLevel.FULL
[1m[94m47 |[0m         self.failure_count = 0
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:50:1
   [1m[94m|[0m
[1m[94m48 |[0m         self.success_count = 0
[1m[94m49 |[0m         self.last_check_time = time.time()
[1m[94m50 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m51 |[0m         # Callbacks cho tá»«ng level
[1m[94m52 |[0m         self.level_callbacks: Dict[str, Callable] = {}
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:52:31
   [1m[94m|[0m
[1m[94m51 |[0m         # Callbacks cho tá»«ng level
[1m[94m52 |[0m         self.level_callbacks: Dict[str, Callable] = {}
   [1m[94m|[0m                               [1m[91m^^^^[0m
[1m[94m53 |[0m     
[1m[94m54 |[0m     def register_callback(self, level: str, callback: Callable):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:53:1
   [1m[94m|[0m
[1m[94m51 |[0m         # Callbacks cho tá»«ng level
[1m[94m52 |[0m         self.level_callbacks: Dict[str, Callable] = {}
[1m[94m53 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m54 |[0m     def register_callback(self, level: str, callback: Callable):
[1m[94m55 |[0m         """ÄÄƒng kÃ½ callback cho má»™t level"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:57:1
   [1m[94m|[0m
[1m[94m55 |[0m         """ÄÄƒng kÃ½ callback cho má»™t level"""
[1m[94m56 |[0m         self.level_callbacks[level] = callback
[1m[94m57 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m58 |[0m     def record_success(self):
[1m[94m59 |[0m         """Ghi nháº­n success"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:63:1
   [1m[94m|[0m
[1m[94m61 |[0m         self.failure_count = 0
[1m[94m62 |[0m         self._check_level()
[1m[94m63 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m64 |[0m     def record_failure(self):
[1m[94m65 |[0m         """Ghi nháº­n failure"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:69:1
   [1m[94m|[0m
[1m[94m67 |[0m         self.success_count = 0
[1m[94m68 |[0m         self._check_level()
[1m[94m69 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m70 |[0m     def _check_level(self):
[1m[94m71 |[0m         """Kiá»ƒm tra vÃ  cáº­p nháº­t level"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:73:1
   [1m[94m|[0m
[1m[94m71 |[0m         """Kiá»ƒm tra vÃ  cáº­p nháº­t level"""
[1m[94m72 |[0m         old_level = self.current_level
[1m[94m73 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m74 |[0m         # Giáº£m level náº¿u cÃ³ quÃ¡ nhiá»u lá»—i
[1m[94m75 |[0m         if self.failure_count >= self.failure_threshold:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:82:1
   [1m[94m|[0m
[1m[94m80 |[0m             elif self.current_level == DegradationLevel.MINIMAL:
[1m[94m81 |[0m                 self.current_level = DegradationLevel.FAILED
[1m[94m82 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m83 |[0m         # TÄƒng level náº¿u cÃ³ nhiá»u success
[1m[94m84 |[0m         elif self.success_count >= self.recovery_threshold:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:91:1
   [1m[94m|[0m
[1m[94m89 |[0m             elif self.current_level == DegradationLevel.REDUCED:
[1m[94m90 |[0m                 self.current_level = DegradationLevel.FULL
[1m[94m91 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m92 |[0m         # Gá»i callback náº¿u level thay Ä‘á»•i
[1m[94m93 |[0m         if old_level != self.current_level and self.current_level in self.level_callbacks:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:98:1
    [1m[94m|[0m
[1m[94m 96 |[0m             except Exception:
[1m[94m 97 |[0m                 pass
[1m[94m 98 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m 99 |[0m     def get_level(self) -> str:
[1m[94m100 |[0m         """Láº¥y current level"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:102:1
    [1m[94m|[0m
[1m[94m100 |[0m         """Láº¥y current level"""
[1m[94m101 |[0m         return self.current_level
[1m[94m102 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m103 |[0m     def is_available(self) -> bool:
[1m[94m104 |[0m         """Kiá»ƒm tra xem service cÃ³ available khÃ´ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:106:1
    [1m[94m|[0m
[1m[94m104 |[0m         """Kiá»ƒm tra xem service cÃ³ available khÃ´ng"""
[1m[94m105 |[0m         return self.current_level != DegradationLevel.FAILED
[1m[94m106 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m107 |[0m     def should_skip(self) -> bool:
[1m[94m108 |[0m         """Kiá»ƒm tra xem cÃ³ nÃªn skip operation khÃ´ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:110:1
    [1m[94m|[0m
[1m[94m108 |[0m         """Kiá»ƒm tra xem cÃ³ nÃªn skip operation khÃ´ng"""
[1m[94m109 |[0m         return self.current_level == DegradationLevel.FAILED
[1m[94m110 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m111 |[0m     def get_stats(self) -> Dict[str, Any]:
[1m[94m112 |[0m         """Láº¥y thá»‘ng kÃª"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:111:28
    [1m[94m|[0m
[1m[94m109 |[0m         return self.current_level == DegradationLevel.FAILED
[1m[94m110 |[0m     
[1m[94m111 |[0m     def get_stats(self) -> Dict[str, Any]:
    [1m[94m|[0m                            [1m[91m^^^^[0m
[1m[94m112 |[0m         """Láº¥y thá»‘ng kÃª"""
[1m[94m113 |[0m         return {
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:129:1
    [1m[94m|[0m
[1m[94m127 |[0m     """
[1m[94m128 |[0m     Decorator Ä‘á»ƒ Ã¡p dá»¥ng graceful degradation cho function
[1m[94m129 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m130 |[0m     Args:
[1m[94m131 |[0m         degradation_manager: GracefulDegradation instance
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:134:1
    [1m[94m|[0m
[1m[94m132 |[0m         fallback_value: GiÃ¡ trá»‹ tráº£ vá» khi degraded
[1m[94m133 |[0m         skip_on_failed: CÃ³ skip function khi level = FAILED khÃ´ng
[1m[94m134 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m135 |[0m     Example:
[1m[94m136 |[0m         @graceful_degradation(degradation_manager, fallback_value=[])
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:146:1
    [1m[94m|[0m
[1m[94m144 |[0m             if skip_on_failed and degradation_manager.should_skip():
[1m[94m145 |[0m                 return fallback_value
[1m[94m146 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m147 |[0m             try:
[1m[94m148 |[0m                 result = func(*args, **kwargs)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mF841 [0m[[1m[96m*[0m] [1mLocal variable `e` is assigned to but never used[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:151:33
    [1m[94m|[0m
[1m[94m149 |[0m                 degradation_manager.record_success()
[1m[94m150 |[0m                 return result
[1m[94m151 |[0m             except Exception as e:
    [1m[94m|[0m                                 [1m[91m^[0m
[1m[94m152 |[0m                 degradation_manager.record_failure()
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove assignment to unused variable `e`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:153:1
    [1m[94m|[0m
[1m[94m151 |[0m             except Exception as e:
[1m[94m152 |[0m                 degradation_manager.record_failure()
[1m[94m153 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m154 |[0m                 # Náº¿u á»Ÿ level MINIMAL hoáº·c FAILED, return fallback
[1m[94m155 |[0m                 if degradation_manager.get_level() in [
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:160:1
    [1m[94m|[0m
[1m[94m158 |[0m                 ]:
[1m[94m159 |[0m                     return fallback_value
[1m[94m160 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m161 |[0m                 # á»ž level khÃ¡c, raise exception
[1m[94m162 |[0m                 raise
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:163:1
    [1m[94m|[0m
[1m[94m161 |[0m                 # á»ž level khÃ¡c, raise exception
[1m[94m162 |[0m                 raise
[1m[94m163 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m164 |[0m         return wrapper
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:165:1
    [1m[94m|[0m
[1m[94m164 |[0m         return wrapper
[1m[94m165 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m166 |[0m     return decorator
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:174:1
    [1m[94m|[0m
[1m[94m172 |[0m     Tá»± Ä‘á»™ng degrade khi service khÃ´ng available
[1m[94m173 |[0m     """
[1m[94m174 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m175 |[0m     def __init__(self):
[1m[94m176 |[0m         self.services: Dict[str, GracefulDegradation] = {}
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:176:24
    [1m[94m|[0m
[1m[94m175 |[0m     def __init__(self):
[1m[94m176 |[0m         self.services: Dict[str, GracefulDegradation] = {}
    [1m[94m|[0m                        [1m[91m^^^^[0m
[1m[94m177 |[0m     
[1m[94m178 |[0m     def register_service(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:177:1
    [1m[94m|[0m
[1m[94m175 |[0m     def __init__(self):
[1m[94m176 |[0m         self.services: Dict[str, GracefulDegradation] = {}
[1m[94m177 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m178 |[0m     def register_service(
[1m[94m179 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:192:1
    [1m[94m|[0m
[1m[94m190 |[0m         self.services[name] = degradation
[1m[94m191 |[0m         return degradation
[1m[94m192 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m193 |[0m     def get_service(self, name: str) -> Optional[GracefulDegradation]:
[1m[94m194 |[0m         """Láº¥y service degradation"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:193:41
    [1m[94m|[0m
[1m[94m191 |[0m         return degradation
[1m[94m192 |[0m     
[1m[94m193 |[0m     def get_service(self, name: str) -> Optional[GracefulDegradation]:
    [1m[94m|[0m                                         [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m194 |[0m         """Láº¥y service degradation"""
[1m[94m195 |[0m         return self.services.get(name)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:196:1
    [1m[94m|[0m
[1m[94m194 |[0m         """Láº¥y service degradation"""
[1m[94m195 |[0m         return self.services.get(name)
[1m[94m196 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m197 |[0m     def is_service_available(self, name: str) -> bool:
[1m[94m198 |[0m         """Kiá»ƒm tra service cÃ³ available khÃ´ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:201:1
    [1m[94m|[0m
[1m[94m199 |[0m         service = self.services.get(name)
[1m[94m200 |[0m         return service.is_available() if service else True
[1m[94m201 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m202 |[0m     def get_all_stats(self) -> Dict[str, Any]:
[1m[94m203 |[0m         """Láº¥y thá»‘ng kÃª táº¥t cáº£ services"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\resilience\graceful_degradation.py:202:32
    [1m[94m|[0m
[1m[94m200 |[0m         return service.is_available() if service else True
[1m[94m201 |[0m     
[1m[94m202 |[0m     def get_all_stats(self) -> Dict[str, Any]:
    [1m[94m|[0m                                [1m[91m^^^^[0m
[1m[94m203 |[0m         """Láº¥y thá»‘ng kÃª táº¥t cáº£ services"""
[1m[94m204 |[0m         return {
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:9:1
   [1m[94m|[0m
[1m[94m 7 |[0m   """
[1m[94m 8 |[0m
[1m[94m 9 |[0m [1m[91m/[0m from .postgres_storage import PostgresStorage
[1m[94m10 |[0m [1m[91m|[0m from .redis_cache import (
[1m[94m11 |[0m [1m[91m|[0m     RedisCache,
[1m[94m12 |[0m [1m[91m|[0m     RedisRateLimiter,
[1m[94m13 |[0m [1m[91m|[0m     RedisLock,
[1m[94m14 |[0m [1m[91m|[0m     get_redis_cache,
[1m[94m15 |[0m [1m[91m|[0m     get_redis_rate_limiter,
[1m[94m16 |[0m [1m[91m|[0m     get_redis_lock,
[1m[94m17 |[0m [1m[91m|[0m )
   [1m[94m|[0m [1m[91m|_^[0m
[1m[94m18 |[0m
[1m[94m19 |[0m   # Optional imports (cÃ³ thá»ƒ fail náº¿u dependencies khÃ´ng cÃ³)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:21:5
   [1m[94m|[0m
[1m[94m19 |[0m   # Optional imports (cÃ³ thá»ƒ fail náº¿u dependencies khÃ´ng cÃ³)
[1m[94m20 |[0m   try:
[1m[94m21 |[0m [1m[91m/[0m     from .multi_level_cache import (
[1m[94m22 |[0m [1m[91m|[0m         MultiLevelCache,
[1m[94m23 |[0m [1m[91m|[0m         LRUCache,
[1m[94m24 |[0m [1m[91m|[0m         FileCache,
[1m[94m25 |[0m [1m[91m|[0m         get_multi_level_cache,
[1m[94m26 |[0m [1m[91m|[0m     )
   [1m[94m|[0m [1m[91m|_____^[0m
[1m[94m27 |[0m       _MULTI_LEVEL_CACHE_AVAILABLE = True
[1m[94m28 |[0m   except ImportError:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[1m`.multi_level_cache.MultiLevelCache` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:22:9
   [1m[94m|[0m
[1m[94m20 |[0m try:
[1m[94m21 |[0m     from .multi_level_cache import (
[1m[94m22 |[0m         MultiLevelCache,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m23 |[0m         LRUCache,
[1m[94m24 |[0m         FileCache,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.multi_level_cache.LRUCache` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:23:9
   [1m[94m|[0m
[1m[94m21 |[0m     from .multi_level_cache import (
[1m[94m22 |[0m         MultiLevelCache,
[1m[94m23 |[0m         LRUCache,
   [1m[94m|[0m         [1m[91m^^^^^^^^[0m
[1m[94m24 |[0m         FileCache,
[1m[94m25 |[0m         get_multi_level_cache,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.multi_level_cache.FileCache` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:24:9
   [1m[94m|[0m
[1m[94m22 |[0m         MultiLevelCache,
[1m[94m23 |[0m         LRUCache,
[1m[94m24 |[0m         FileCache,
   [1m[94m|[0m         [1m[91m^^^^^^^^^[0m
[1m[94m25 |[0m         get_multi_level_cache,
[1m[94m26 |[0m     )
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.multi_level_cache.get_multi_level_cache` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:25:9
   [1m[94m|[0m
[1m[94m23 |[0m         LRUCache,
[1m[94m24 |[0m         FileCache,
[1m[94m25 |[0m         get_multi_level_cache,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m26 |[0m     )
[1m[94m27 |[0m     _MULTI_LEVEL_CACHE_AVAILABLE = True
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:32:5
   [1m[94m|[0m
[1m[94m31 |[0m   try:
[1m[94m32 |[0m [1m[91m/[0m     from .compression import (
[1m[94m33 |[0m [1m[91m|[0m         compress_json,
[1m[94m34 |[0m [1m[91m|[0m         decompress_json,
[1m[94m35 |[0m [1m[91m|[0m         write_compressed_json,
[1m[94m36 |[0m [1m[91m|[0m         read_compressed_json,
[1m[94m37 |[0m [1m[91m|[0m         get_compression_ratio,
[1m[94m38 |[0m [1m[91m|[0m     )
   [1m[94m|[0m [1m[91m|_____^[0m
[1m[94m39 |[0m       _COMPRESSION_AVAILABLE = True
[1m[94m40 |[0m   except ImportError:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[1m`.compression.compress_json` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:33:9
   [1m[94m|[0m
[1m[94m31 |[0m try:
[1m[94m32 |[0m     from .compression import (
[1m[94m33 |[0m         compress_json,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^[0m
[1m[94m34 |[0m         decompress_json,
[1m[94m35 |[0m         write_compressed_json,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.compression.decompress_json` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:34:9
   [1m[94m|[0m
[1m[94m32 |[0m     from .compression import (
[1m[94m33 |[0m         compress_json,
[1m[94m34 |[0m         decompress_json,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m35 |[0m         write_compressed_json,
[1m[94m36 |[0m         read_compressed_json,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.compression.write_compressed_json` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:35:9
   [1m[94m|[0m
[1m[94m33 |[0m         compress_json,
[1m[94m34 |[0m         decompress_json,
[1m[94m35 |[0m         write_compressed_json,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m36 |[0m         read_compressed_json,
[1m[94m37 |[0m         get_compression_ratio,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.compression.read_compressed_json` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:36:9
   [1m[94m|[0m
[1m[94m34 |[0m         decompress_json,
[1m[94m35 |[0m         write_compressed_json,
[1m[94m36 |[0m         read_compressed_json,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m37 |[0m         get_compression_ratio,
[1m[94m38 |[0m     )
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[1m`.compression.get_compression_ratio` imported but unused; consider using `importlib.util.find_spec` to test for availability[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\__init__.py:37:9
   [1m[94m|[0m
[1m[94m35 |[0m         write_compressed_json,
[1m[94m36 |[0m         read_compressed_json,
[1m[94m37 |[0m         get_compression_ratio,
   [1m[94m|[0m         [1m[91m^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m38 |[0m     )
[1m[94m39 |[0m     _COMPRESSION_AVAILABLE = True
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`typing.Optional` imported but unused[0m
 [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:9:25
  [1m[94m|[0m
[1m[94m7 |[0m import json
[1m[94m8 |[0m from pathlib import Path
[1m[94m9 |[0m from typing import Any, Optional
  [1m[94m|[0m                         [1m[91m^^^^^^^^[0m
  [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import: `typing.Optional`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:15:1
   [1m[94m|[0m
[1m[94m13 |[0m     """
[1m[94m14 |[0m     NÃ©n JSON data thÃ nh gzip bytes
[1m[94m15 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m16 |[0m     Args:
[1m[94m17 |[0m         data: Data cáº§n nÃ©n (sáº½ Ä‘Æ°á»£c serialize thÃ nh JSON)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:19:1
   [1m[94m|[0m
[1m[94m17 |[0m         data: Data cáº§n nÃ©n (sáº½ Ä‘Æ°á»£c serialize thÃ nh JSON)
[1m[94m18 |[0m         level: Compression level (1-9, máº·c Ä‘á»‹nh: 6)
[1m[94m19 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m20 |[0m     Returns:
[1m[94m21 |[0m         Compressed bytes
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:30:1
   [1m[94m|[0m
[1m[94m28 |[0m     """
[1m[94m29 |[0m     Giáº£i nÃ©n gzip bytes thÃ nh JSON data
[1m[94m30 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m31 |[0m     Args:
[1m[94m32 |[0m         compressed_data: Compressed bytes
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:33:1
   [1m[94m|[0m
[1m[94m31 |[0m     Args:
[1m[94m32 |[0m         compressed_data: Compressed bytes
[1m[94m33 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m34 |[0m     Returns:
[1m[94m35 |[0m         Decompressed data (parsed JSON)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:45:1
   [1m[94m|[0m
[1m[94m43 |[0m     """
[1m[94m44 |[0m     Ghi JSON data vÃ o file vá»›i compression
[1m[94m45 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m46 |[0m     Args:
[1m[94m47 |[0m         filepath: ÄÆ°á»ng dáº«n file (sáº½ tá»± Ä‘á»™ng thÃªm .gz náº¿u chÆ°a cÃ³)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:50:1
   [1m[94m|[0m
[1m[94m48 |[0m         data: Data cáº§n ghi
[1m[94m49 |[0m         level: Compression level (1-9)
[1m[94m50 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m51 |[0m     Returns:
[1m[94m52 |[0m         True náº¿u thÃ nh cÃ´ng
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:55:1
   [1m[94m|[0m
[1m[94m53 |[0m     """
[1m[94m54 |[0m     filepath = Path(filepath)
[1m[94m55 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m56 |[0m     # Äáº£m báº£o thÆ° má»¥c tá»“n táº¡i
[1m[94m57 |[0m     filepath.parent.mkdir(parents=True, exist_ok=True)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:58:1
   [1m[94m|[0m
[1m[94m56 |[0m     # Äáº£m báº£o thÆ° má»¥c tá»“n táº¡i
[1m[94m57 |[0m     filepath.parent.mkdir(parents=True, exist_ok=True)
[1m[94m58 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m59 |[0m     # ThÃªm .gz náº¿u chÆ°a cÃ³
[1m[94m60 |[0m     if not filepath.suffix == '.gz':
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:62:1
   [1m[94m|[0m
[1m[94m60 |[0m     if not filepath.suffix == '.gz':
[1m[94m61 |[0m         filepath = filepath.with_suffix(filepath.suffix + '.gz')
[1m[94m62 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m63 |[0m     try:
[1m[94m64 |[0m         compressed = compress_json(data, level=level)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:75:1
   [1m[94m|[0m
[1m[94m73 |[0m     """
[1m[94m74 |[0m     Äá»c JSON data tá»« compressed file
[1m[94m75 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m76 |[0m     Args:
[1m[94m77 |[0m         filepath: ÄÆ°á»ng dáº«n file (.gz hoáº·c khÃ´ng)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:79:1
   [1m[94m|[0m
[1m[94m77 |[0m         filepath: ÄÆ°á»ng dáº«n file (.gz hoáº·c khÃ´ng)
[1m[94m78 |[0m         default: GiÃ¡ trá»‹ máº·c Ä‘á»‹nh náº¿u lá»—i
[1m[94m79 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m80 |[0m     Returns:
[1m[94m81 |[0m         Decompressed data hoáº·c default
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:84:1
   [1m[94m|[0m
[1m[94m82 |[0m     """
[1m[94m83 |[0m     filepath = Path(filepath)
[1m[94m84 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m85 |[0m     # Thá»­ vá»›i .gz extension náº¿u chÆ°a cÃ³
[1m[94m86 |[0m     if not filepath.suffix == '.gz':
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:90:1
   [1m[94m|[0m
[1m[94m88 |[0m         if gz_filepath.exists():
[1m[94m89 |[0m             filepath = gz_filepath
[1m[94m90 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m91 |[0m     if not filepath.exists():
[1m[94m92 |[0m         return default
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:93:1
   [1m[94m|[0m
[1m[94m91 |[0m     if not filepath.exists():
[1m[94m92 |[0m         return default
[1m[94m93 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m94 |[0m     try:
[1m[94m95 |[0m         with open(filepath, 'rb') as f:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:105:1
    [1m[94m|[0m
[1m[94m103 |[0m     """
[1m[94m104 |[0m     TÃ­nh tá»· lá»‡ compression
[1m[94m105 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m106 |[0m     Args:
[1m[94m107 |[0m         original_data: Data gá»‘c
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:109:1
    [1m[94m|[0m
[1m[94m107 |[0m         original_data: Data gá»‘c
[1m[94m108 |[0m         compressed_data: Data Ä‘Ã£ nÃ©n (bytes)
[1m[94m109 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m110 |[0m     Returns:
[1m[94m111 |[0m         Tá»· lá»‡ compression (0-1, cÃ ng nhá» cÃ ng tá»‘t)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:115:1
    [1m[94m|[0m
[1m[94m113 |[0m     original_size = len(json.dumps(original_data, ensure_ascii=False).encode('utf-8'))
[1m[94m114 |[0m     compressed_size = len(compressed_data)
[1m[94m115 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m116 |[0m     if original_size == 0:
[1m[94m117 |[0m         return 0.0
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\compression.py:118:1
    [1m[94m|[0m
[1m[94m116 |[0m     if original_size == 0:
[1m[94m117 |[0m         return 0.0
[1m[94m118 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m119 |[0m     return compressed_size / original_size
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:12:1
   [1m[94m|[0m
[1m[94m10 |[0m   """
[1m[94m11 |[0m
[1m[94m12 |[0m [1m[91m/[0m import hashlib
[1m[94m13 |[0m [1m[91m|[0m import json
[1m[94m14 |[0m [1m[91m|[0m import gzip
[1m[94m15 |[0m [1m[91m|[0m import time
[1m[94m16 |[0m [1m[91m|[0m from collections import OrderedDict
[1m[94m17 |[0m [1m[91m|[0m from pathlib import Path
[1m[94m18 |[0m [1m[91m|[0m from typing import Any, Optional
   [1m[94m|[0m [1m[91m|________________________________^[0m
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:31:1
   [1m[94m|[0m
[1m[94m29 |[0m class LRUCache:
[1m[94m30 |[0m     """In-memory LRU cache (L1)"""
[1m[94m31 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m32 |[0m     def __init__(self, maxsize: int = 1000):
[1m[94m33 |[0m         """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:41:1
   [1m[94m|[0m
[1m[94m39 |[0m         self.hits = 0
[1m[94m40 |[0m         self.misses = 0
[1m[94m41 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m42 |[0m     def get(self, key: str) -> Optional[Any]:
[1m[94m43 |[0m         """Láº¥y giÃ¡ trá»‹ tá»« cache"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:42:32
   [1m[94m|[0m
[1m[94m40 |[0m         self.misses = 0
[1m[94m41 |[0m     
[1m[94m42 |[0m     def get(self, key: str) -> Optional[Any]:
   [1m[94m|[0m                                [1m[91m^^^^^^^^^^^^^[0m
[1m[94m43 |[0m         """Láº¥y giÃ¡ trá»‹ tá»« cache"""
[1m[94m44 |[0m         if key in self.cache:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:51:1
   [1m[94m|[0m
[1m[94m49 |[0m         self.misses += 1
[1m[94m50 |[0m         return None
[1m[94m51 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m52 |[0m     def set(self, key: str, value: Any) -> None:
[1m[94m53 |[0m         """LÆ°u giÃ¡ trá»‹ vÃ o cache"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:62:1
   [1m[94m|[0m
[1m[94m60 |[0m                 self.cache.popitem(last=False)  # Remove oldest
[1m[94m61 |[0m         self.cache[key] = value
[1m[94m62 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m63 |[0m     def delete(self, key: str) -> bool:
[1m[94m64 |[0m         """XÃ³a key khá»i cache"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:69:1
   [1m[94m|[0m
[1m[94m67 |[0m             return True
[1m[94m68 |[0m         return False
[1m[94m69 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m70 |[0m     def clear(self) -> None:
[1m[94m71 |[0m         """XÃ³a toÃ n bá»™ cache"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:75:1
   [1m[94m|[0m
[1m[94m73 |[0m         self.hits = 0
[1m[94m74 |[0m         self.misses = 0
[1m[94m75 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m76 |[0m     def stats(self) -> dict:
[1m[94m77 |[0m         """Láº¥y thá»‘ng kÃª cache"""
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:91:1
   [1m[94m|[0m
[1m[94m89 |[0m class FileCache:
[1m[94m90 |[0m     """File-based cache vá»›i compression (L3)"""
[1m[94m91 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m92 |[0m     def __init__(self, cache_dir: str | Path, compress: bool = True):
[1m[94m93 |[0m         """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:102:1
    [1m[94m|[0m
[1m[94m100 |[0m         self.compress = compress
[1m[94m101 |[0m         self.extension = ".json.gz" if compress else ".json"
[1m[94m102 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m103 |[0m     def _get_filepath(self, key: str) -> Path:
[1m[94m104 |[0m         """Láº¥y Ä‘Æ°á»ng dáº«n file tá»« key"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:108:1
    [1m[94m|[0m
[1m[94m106 |[0m         key_hash = hashlib.md5(key.encode()).hexdigest()
[1m[94m107 |[0m         return self.cache_dir / f"{key_hash}{self.extension}"
[1m[94m108 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m109 |[0m     def get(self, key: str) -> Optional[Any]:
[1m[94m110 |[0m         """Láº¥y giÃ¡ trá»‹ tá»« file cache"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:109:32
    [1m[94m|[0m
[1m[94m107 |[0m         return self.cache_dir / f"{key_hash}{self.extension}"
[1m[94m108 |[0m     
[1m[94m109 |[0m     def get(self, key: str) -> Optional[Any]:
    [1m[94m|[0m                                [1m[91m^^^^^^^^^^^^^[0m
[1m[94m110 |[0m         """Láº¥y giÃ¡ trá»‹ tá»« file cache"""
[1m[94m111 |[0m         filepath = self._get_filepath(key)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:114:1
    [1m[94m|[0m
[1m[94m112 |[0m         if not filepath.exists():
[1m[94m113 |[0m             return None
[1m[94m114 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m115 |[0m         try:
[1m[94m116 |[0m             if self.compress:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP015 [0m[[1m[96m*[0m] [1mUnnecessary mode argument[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:120:37
    [1m[94m|[0m
[1m[94m118 |[0m                     data = json.load(f)
[1m[94m119 |[0m             else:
[1m[94m120 |[0m                 with open(filepath, 'r', encoding='utf-8') as f:
    [1m[94m|[0m                                     [1m[91m^^^[0m
[1m[94m121 |[0m                     data = json.load(f)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove mode argument[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:122:1
    [1m[94m|[0m
[1m[94m120 |[0m                 with open(filepath, 'r', encoding='utf-8') as f:
[1m[94m121 |[0m                     data = json.load(f)
[1m[94m122 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m123 |[0m             # Check expiration
[1m[94m124 |[0m             if 'expires_at' in data:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:128:1
    [1m[94m|[0m
[1m[94m126 |[0m                     filepath.unlink()  # Delete expired file
[1m[94m127 |[0m                     return None
[1m[94m128 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m129 |[0m             return data.get('value')
[1m[94m130 |[0m         except Exception:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:137:1
    [1m[94m|[0m
[1m[94m135 |[0m                 pass
[1m[94m136 |[0m             return None
[1m[94m137 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m138 |[0m     def set(self, key: str, value: Any, ttl: Optional[int] = None) -> bool:
[1m[94m139 |[0m         """LÆ°u giÃ¡ trá»‹ vÃ o file cache"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:138:46
    [1m[94m|[0m
[1m[94m136 |[0m             return None
[1m[94m137 |[0m     
[1m[94m138 |[0m     def set(self, key: str, value: Any, ttl: Optional[int] = None) -> bool:
    [1m[94m|[0m                                              [1m[91m^^^^^^^^^^^^^[0m
[1m[94m139 |[0m         """LÆ°u giÃ¡ trá»‹ vÃ o file cache"""
[1m[94m140 |[0m         filepath = self._get_filepath(key)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:148:1
    [1m[94m|[0m
[1m[94m146 |[0m             if ttl:
[1m[94m147 |[0m                 data['expires_at'] = time.time() + ttl
[1m[94m148 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m149 |[0m             if self.compress:
[1m[94m150 |[0m                 with gzip.open(filepath, 'wt', encoding='utf-8') as f:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:158:1
    [1m[94m|[0m
[1m[94m156 |[0m         except Exception:
[1m[94m157 |[0m             return False
[1m[94m158 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m159 |[0m     def delete(self, key: str) -> bool:
[1m[94m160 |[0m         """XÃ³a file cache"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:169:1
    [1m[94m|[0m
[1m[94m167 |[0m         except Exception:
[1m[94m168 |[0m             return False
[1m[94m169 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m170 |[0m     def exists(self, key: str) -> bool:
[1m[94m171 |[0m         """Kiá»ƒm tra file cÃ³ tá»“n táº¡i khÃ´ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:182:1
    [1m[94m|[0m
[1m[94m180 |[0m     - L3: File cache (persistent)
[1m[94m181 |[0m     """
[1m[94m182 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m183 |[0m     def __init__(
[1m[94m184 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:187:20
    [1m[94m|[0m
[1m[94m185 |[0m         l1_maxsize: int = 1000,
[1m[94m186 |[0m         redis_url: str = "redis://redis:6379/1",
[1m[94m187 |[0m         cache_dir: Optional[str | Path] = None,
    [1m[94m|[0m                    [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m188 |[0m         default_ttl: int = 86400,
[1m[94m189 |[0m         enable_l1: bool = True,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:207:1
    [1m[94m|[0m
[1m[94m205 |[0m         # L1: In-memory LRU
[1m[94m206 |[0m         self.l1 = LRUCache(maxsize=l1_maxsize) if enable_l1 else None
[1m[94m207 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m208 |[0m         # L2: Redis
[1m[94m209 |[0m         self.l2 = None
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:216:1
    [1m[94m|[0m
[1m[94m214 |[0m             except Exception:
[1m[94m215 |[0m                 pass
[1m[94m216 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m217 |[0m         # L3: File cache
[1m[94m218 |[0m         self.l3 = None
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:229:1
    [1m[94m|[0m
[1m[94m227 |[0m                     cache_dir = Path("data/raw/cache")
[1m[94m228 |[0m             self.l3 = FileCache(cache_dir=cache_dir, compress=compress_l3)
[1m[94m229 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m230 |[0m         self.default_ttl = default_ttl
[1m[94m231 |[0m         self.stats = {
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:238:1
    [1m[94m|[0m
[1m[94m236 |[0m             'writes': 0,
[1m[94m237 |[0m         }
[1m[94m238 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m239 |[0m     def get(self, key: str) -> Optional[Any]:
[1m[94m240 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:239:32
    [1m[94m|[0m
[1m[94m237 |[0m         }
[1m[94m238 |[0m     
[1m[94m239 |[0m     def get(self, key: str) -> Optional[Any]:
    [1m[94m|[0m                                [1m[91m^^^^^^^^^^^^^[0m
[1m[94m240 |[0m         """
[1m[94m241 |[0m         Láº¥y giÃ¡ trá»‹ tá»« cache (check L1 -> L2 -> L3)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:242:1
    [1m[94m|[0m
[1m[94m240 |[0m         """
[1m[94m241 |[0m         Láº¥y giÃ¡ trá»‹ tá»« cache (check L1 -> L2 -> L3)
[1m[94m242 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m243 |[0m         Args:
[1m[94m244 |[0m             key: Cache key
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:245:1
    [1m[94m|[0m
[1m[94m243 |[0m         Args:
[1m[94m244 |[0m             key: Cache key
[1m[94m245 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m246 |[0m         Returns:
[1m[94m247 |[0m             GiÃ¡ trá»‹ tá»« cache hoáº·c None
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:256:1
    [1m[94m|[0m
[1m[94m254 |[0m                 # Promote to L1 if found in lower levels
[1m[94m255 |[0m                 return value
[1m[94m256 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m257 |[0m         # L2: Redis
[1m[94m258 |[0m         if self.l2:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:269:1
    [1m[94m|[0m
[1m[94m267 |[0m             except Exception:
[1m[94m268 |[0m                 pass
[1m[94m269 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m270 |[0m         # L3: File cache
[1m[94m271 |[0m         if self.l3:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:284:1
    [1m[94m|[0m
[1m[94m282 |[0m                         pass
[1m[94m283 |[0m                 return value
[1m[94m284 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m285 |[0m         self.stats['misses'] += 1
[1m[94m286 |[0m         return None
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:287:1
    [1m[94m|[0m
[1m[94m285 |[0m         self.stats['misses'] += 1
[1m[94m286 |[0m         return None
[1m[94m287 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m288 |[0m     def set(self, key: str, value: Any, ttl: Optional[int] = None) -> bool:
[1m[94m289 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:288:46
    [1m[94m|[0m
[1m[94m286 |[0m         return None
[1m[94m287 |[0m     
[1m[94m288 |[0m     def set(self, key: str, value: Any, ttl: Optional[int] = None) -> bool:
    [1m[94m|[0m                                              [1m[91m^^^^^^^^^^^^^[0m
[1m[94m289 |[0m         """
[1m[94m290 |[0m         LÆ°u giÃ¡ trá»‹ vÃ o táº¥t cáº£ cÃ¡c táº§ng cache
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:291:1
    [1m[94m|[0m
[1m[94m289 |[0m         """
[1m[94m290 |[0m         LÆ°u giÃ¡ trá»‹ vÃ o táº¥t cáº£ cÃ¡c táº§ng cache
[1m[94m291 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m292 |[0m         Args:
[1m[94m293 |[0m             key: Cache key
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:296:1
    [1m[94m|[0m
[1m[94m294 |[0m             value: GiÃ¡ trá»‹ cáº§n cache
[1m[94m295 |[0m             ttl: Time to live (giÃ¢y), None = dÃ¹ng default_ttl
[1m[94m296 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m297 |[0m         Returns:
[1m[94m298 |[0m             True náº¿u lÆ°u thÃ nh cÃ´ng Ã­t nháº¥t 1 táº§ng
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:302:1
    [1m[94m|[0m
[1m[94m300 |[0m         success = False
[1m[94m301 |[0m         ttl = ttl or self.default_ttl
[1m[94m302 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m303 |[0m         # L1: In-memory
[1m[94m304 |[0m         if self.l1:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:310:1
    [1m[94m|[0m
[1m[94m308 |[0m             except Exception:
[1m[94m309 |[0m                 pass
[1m[94m310 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m311 |[0m         # L2: Redis
[1m[94m312 |[0m         if self.l2:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:318:1
    [1m[94m|[0m
[1m[94m316 |[0m             except Exception:
[1m[94m317 |[0m                 pass
[1m[94m318 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m319 |[0m         # L3: File cache
[1m[94m320 |[0m         if self.l3:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:326:1
    [1m[94m|[0m
[1m[94m324 |[0m             except Exception:
[1m[94m325 |[0m                 pass
[1m[94m326 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m327 |[0m         if success:
[1m[94m328 |[0m             self.stats['writes'] += 1
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:329:1
    [1m[94m|[0m
[1m[94m327 |[0m         if success:
[1m[94m328 |[0m             self.stats['writes'] += 1
[1m[94m329 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m330 |[0m         return success
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:331:1
    [1m[94m|[0m
[1m[94m330 |[0m         return success
[1m[94m331 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m332 |[0m     def delete(self, key: str) -> bool:
[1m[94m333 |[0m         """XÃ³a key khá»i táº¥t cáº£ cÃ¡c táº§ng cache"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:335:1
    [1m[94m|[0m
[1m[94m333 |[0m         """XÃ³a key khá»i táº¥t cáº£ cÃ¡c táº§ng cache"""
[1m[94m334 |[0m         results = []
[1m[94m335 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m336 |[0m         if self.l1:
[1m[94m337 |[0m             results.append(self.l1.delete(key))
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:338:1
    [1m[94m|[0m
[1m[94m336 |[0m         if self.l1:
[1m[94m337 |[0m             results.append(self.l1.delete(key))
[1m[94m338 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m339 |[0m         if self.l2:
[1m[94m340 |[0m             try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:344:1
    [1m[94m|[0m
[1m[94m342 |[0m             except Exception:
[1m[94m343 |[0m                 pass
[1m[94m344 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m345 |[0m         if self.l3:
[1m[94m346 |[0m             try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:350:1
    [1m[94m|[0m
[1m[94m348 |[0m             except Exception:
[1m[94m349 |[0m                 pass
[1m[94m350 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m351 |[0m         return any(results)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:352:1
    [1m[94m|[0m
[1m[94m351 |[0m         return any(results)
[1m[94m352 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m353 |[0m     def exists(self, key: str) -> bool:
[1m[94m354 |[0m         """Kiá»ƒm tra key cÃ³ tá»“n táº¡i trong báº¥t ká»³ táº§ng nÃ o"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:370:1
    [1m[94m|[0m
[1m[94m368 |[0m                 pass
[1m[94m369 |[0m         return False
[1m[94m370 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m371 |[0m     def clear(self) -> None:
[1m[94m372 |[0m         """XÃ³a toÃ n bá»™ cache á»Ÿ táº¥t cáº£ cÃ¡c táº§ng"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:382:1
    [1m[94m|[0m
[1m[94m380 |[0m                 pass
[1m[94m381 |[0m         # L3: KhÃ´ng clear file cache (cÃ³ thá»ƒ ráº¥t nhiá»u files)
[1m[94m382 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m383 |[0m     def get_cache_key(self, url: str, cache_type: str = "html") -> str:
[1m[94m384 |[0m         """Táº¡o cache key tá»« URL"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:387:1
    [1m[94m|[0m
[1m[94m385 |[0m         url_hash = hashlib.md5(url.encode()).hexdigest()
[1m[94m386 |[0m         return f"{cache_type}:{url_hash}"
[1m[94m387 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m388 |[0m     def cache_html(self, url: str, html: str, ttl: Optional[int] = None) -> bool:
[1m[94m389 |[0m         """Cache HTML content"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:388:52
    [1m[94m|[0m
[1m[94m386 |[0m         return f"{cache_type}:{url_hash}"
[1m[94m387 |[0m     
[1m[94m388 |[0m     def cache_html(self, url: str, html: str, ttl: Optional[int] = None) -> bool:
    [1m[94m|[0m                                                    [1m[91m^^^^^^^^^^^^^[0m
[1m[94m389 |[0m         """Cache HTML content"""
[1m[94m390 |[0m         key = self.get_cache_key(url, "html")
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:392:1
    [1m[94m|[0m
[1m[94m390 |[0m         key = self.get_cache_key(url, "html")
[1m[94m391 |[0m         return self.set(key, {"url": url, "html": html, "cached_at": time.time()}, ttl=ttl)
[1m[94m392 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m393 |[0m     def get_cached_html(self, url: str) -> Optional[str]:
[1m[94m394 |[0m         """Láº¥y cached HTML"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:393:44
    [1m[94m|[0m
[1m[94m391 |[0m         return self.set(key, {"url": url, "html": html, "cached_at": time.time()}, ttl=ttl)
[1m[94m392 |[0m     
[1m[94m393 |[0m     def get_cached_html(self, url: str) -> Optional[str]:
    [1m[94m|[0m                                            [1m[91m^^^^^^^^^^^^^[0m
[1m[94m394 |[0m         """Láº¥y cached HTML"""
[1m[94m395 |[0m         key = self.get_cache_key(url, "html")
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:400:1
    [1m[94m|[0m
[1m[94m398 |[0m             return cached.get("html")
[1m[94m399 |[0m         return None
[1m[94m400 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m401 |[0m     def cache_products(self, category_url: str, products: list, ttl: Optional[int] = None) -> bool:
[1m[94m402 |[0m         """Cache products tá»« category"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:401:70
    [1m[94m|[0m
[1m[94m399 |[0m         return None
[1m[94m400 |[0m     
[1m[94m401 |[0m     def cache_products(self, category_url: str, products: list, ttl: Optional[int] = None) -> bool:
    [1m[94m|[0m                                                                      [1m[91m^^^^^^^^^^^^^[0m
[1m[94m402 |[0m         """Cache products tá»« category"""
[1m[94m403 |[0m         key = self.get_cache_key(category_url, "products")
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:409:1
    [1m[94m|[0m
[1m[94m407 |[0m             ttl=ttl
[1m[94m408 |[0m         )
[1m[94m409 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m410 |[0m     def get_cached_products(self, category_url: str) -> Optional[list]:
[1m[94m411 |[0m         """Láº¥y cached products"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:410:57
    [1m[94m|[0m
[1m[94m408 |[0m         )
[1m[94m409 |[0m     
[1m[94m410 |[0m     def get_cached_products(self, category_url: str) -> Optional[list]:
    [1m[94m|[0m                                                         [1m[91m^^^^^^^^^^^^^^[0m
[1m[94m411 |[0m         """Láº¥y cached products"""
[1m[94m412 |[0m         key = self.get_cache_key(category_url, "products")
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:417:1
    [1m[94m|[0m
[1m[94m415 |[0m             return cached.get("products")
[1m[94m416 |[0m         return None
[1m[94m417 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m418 |[0m     def cache_product_detail(self, product_id: str, detail: dict, ttl: Optional[int] = None) -> bool:
[1m[94m419 |[0m         """Cache product detail"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:418:72
    [1m[94m|[0m
[1m[94m416 |[0m         return None
[1m[94m417 |[0m     
[1m[94m418 |[0m     def cache_product_detail(self, product_id: str, detail: dict, ttl: Optional[int] = None) -> bool:
    [1m[94m|[0m                                                                        [1m[91m^^^^^^^^^^^^^[0m
[1m[94m419 |[0m         """Cache product detail"""
[1m[94m420 |[0m         key = f"detail:{product_id}"
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:426:1
    [1m[94m|[0m
[1m[94m424 |[0m             ttl=ttl
[1m[94m425 |[0m         )
[1m[94m426 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m427 |[0m     def get_cached_product_detail(self, product_id: str) -> Optional[dict]:
[1m[94m428 |[0m         """Láº¥y cached product detail"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:427:61
    [1m[94m|[0m
[1m[94m425 |[0m         )
[1m[94m426 |[0m     
[1m[94m427 |[0m     def get_cached_product_detail(self, product_id: str) -> Optional[dict]:
    [1m[94m|[0m                                                             [1m[91m^^^^^^^^^^^^^^[0m
[1m[94m428 |[0m         """Láº¥y cached product detail"""
[1m[94m429 |[0m         key = f"detail:{product_id}"
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:434:1
    [1m[94m|[0m
[1m[94m432 |[0m             return cached.get("detail")
[1m[94m433 |[0m         return None
[1m[94m434 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m435 |[0m     def get_stats(self) -> dict:
[1m[94m436 |[0m         """Láº¥y thá»‘ng kÃª cache"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:438:1
    [1m[94m|[0m
[1m[94m436 |[0m         """Láº¥y thá»‘ng kÃª cache"""
[1m[94m437 |[0m         stats = self.stats.copy()
[1m[94m438 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m439 |[0m         if self.l1:
[1m[94m440 |[0m             stats['l1'] = self.l1.stats()
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:441:1
    [1m[94m|[0m
[1m[94m439 |[0m         if self.l1:
[1m[94m440 |[0m             stats['l1'] = self.l1.stats()
[1m[94m441 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m442 |[0m         total_requests = sum([
[1m[94m443 |[0m             stats['l1_hits'],
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:448:1
    [1m[94m|[0m
[1m[94m446 |[0m             stats['misses']
[1m[94m447 |[0m         ])
[1m[94m448 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m449 |[0m         if total_requests > 0:
[1m[94m450 |[0m             stats['overall_hit_rate'] = f"{(total_requests - stats['misses']) / total_requests * 100:.2f}%"
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:453:1
    [1m[94m|[0m
[1m[94m451 |[0m         else:
[1m[94m452 |[0m             stats['overall_hit_rate'] = "0%"
[1m[94m453 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m454 |[0m         return stats
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:458:30
    [1m[94m|[0m
[1m[94m457 |[0m # Singleton instance
[1m[94m458 |[0m _multi_level_cache_instance: Optional[MultiLevelCache] = None
    [1m[94m|[0m                              [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^[0m
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:464:16
    [1m[94m|[0m
[1m[94m462 |[0m     l1_maxsize: int = 1000,
[1m[94m463 |[0m     redis_url: str = "redis://redis:6379/1",
[1m[94m464 |[0m     cache_dir: Optional[str | Path] = None,
    [1m[94m|[0m                [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m465 |[0m     default_ttl: int = 86400,
[1m[94m466 |[0m     enable_l1: bool = True,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:473:1
    [1m[94m|[0m
[1m[94m471 |[0m     """
[1m[94m472 |[0m     Láº¥y MultiLevelCache instance (singleton)
[1m[94m473 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m474 |[0m     Args:
[1m[94m475 |[0m         l1_maxsize: Sá»‘ items tá»‘i Ä‘a trong L1 cache
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:483:1
    [1m[94m|[0m
[1m[94m481 |[0m         enable_l3: Báº­t/táº¯t L3 cache
[1m[94m482 |[0m         compress_l3: NÃ©n file trong L3
[1m[94m483 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m484 |[0m     Returns:
[1m[94m485 |[0m         MultiLevelCache instance
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:488:1
    [1m[94m|[0m
[1m[94m486 |[0m     """
[1m[94m487 |[0m     global _multi_level_cache_instance
[1m[94m488 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m489 |[0m     if _multi_level_cache_instance is None:
[1m[94m490 |[0m         _multi_level_cache_instance = MultiLevelCache(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\multi_level_cache.py:500:1
    [1m[94m|[0m
[1m[94m498 |[0m             compress_l3=compress_l3,
[1m[94m499 |[0m         )
[1m[94m500 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m501 |[0m     return _multi_level_cache_instance
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:5:1
   [1m[94m|[0m
[1m[94m 3 |[0m   Tá»‘i Æ°u: Connection pooling, batch processing, error handling
[1m[94m 4 |[0m   """
[1m[94m 5 |[0m [1m[91m/[0m import os
[1m[94m 6 |[0m [1m[91m|[0m import time
[1m[94m 7 |[0m [1m[91m|[0m from typing import Any, Dict, List, Optional
[1m[94m 8 |[0m [1m[91m|[0m from datetime import datetime
[1m[94m 9 |[0m [1m[91m|[0m import psycopg2
[1m[94m10 |[0m [1m[91m|[0m from psycopg2.extras import execute_values, Json
[1m[94m11 |[0m [1m[91m|[0m from psycopg2.pool import SimpleConnectionPool
[1m[94m12 |[0m [1m[91m|[0m from contextlib import contextmanager
   [1m[94m|[0m [1m[91m|_____________________________________^[0m
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mUP035 [0m[1m`typing.Dict` is deprecated, use `dict` instead[0m
 [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:7:1
  [1m[94m|[0m
[1m[94m5 |[0m import os
[1m[94m6 |[0m import time
[1m[94m7 |[0m from typing import Any, Dict, List, Optional
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m8 |[0m from datetime import datetime
[1m[94m9 |[0m import psycopg2
  [1m[94m|[0m

[1m[91mUP035 [0m[1m`typing.List` is deprecated, use `list` instead[0m
 [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:7:1
  [1m[94m|[0m
[1m[94m5 |[0m import os
[1m[94m6 |[0m import time
[1m[94m7 |[0m from typing import Any, Dict, List, Optional
  [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m8 |[0m from datetime import datetime
[1m[94m9 |[0m import psycopg2
  [1m[94m|[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:55:21
   [1m[94m|[0m
[1m[94m53 |[0m         self.minconn = minconn
[1m[94m54 |[0m         self.maxconn = maxconn
[1m[94m55 |[0m         self._pool: Optional[SimpleConnectionPool] = None
   [1m[94m|[0m                     [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m56 |[0m         self._pool_stats = {
[1m[94m57 |[0m             'total_connections': 0,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mF841 [0m[[1m[96m*[0m] [1mLocal variable `e` is assigned to but never used[0m
  [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:88:37
   [1m[94m|[0m
[1m[94m86 |[0m                     self._pool_stats['total_connections'] = self.maxconn
[1m[94m87 |[0m                     return self._pool
[1m[94m88 |[0m                 except Exception as e:
   [1m[94m|[0m                                     [1m[91m^[0m
[1m[94m89 |[0m                     self._pool_stats['failed_connections'] += 1
[1m[94m90 |[0m                     if attempt < max_retries - 1:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove assignment to unused variable `e`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:109:1
    [1m[94m|[0m
[1m[94m107 |[0m         """
[1m[94m108 |[0m         Context manager Ä‘á»ƒ láº¥y connection tá»« pool vá»›i retry vÃ  health check
[1m[94m109 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m110 |[0m         Args:
[1m[94m111 |[0m             retries: Sá»‘ láº§n retry náº¿u connection lá»—i
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:115:1
    [1m[94m|[0m
[1m[94m113 |[0m         pool = self._get_pool()
[1m[94m114 |[0m         conn = None
[1m[94m115 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m116 |[0m         for attempt in range(retries):
[1m[94m117 |[0m             try:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:119:1
    [1m[94m|[0m
[1m[94m117 |[0m             try:
[1m[94m118 |[0m                 conn = pool.getconn()
[1m[94m119 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m120 |[0m                 # Pre-ping: Check connection health
[1m[94m121 |[0m                 if not self._check_connection(conn):
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:130:1
    [1m[94m|[0m
[1m[94m128 |[0m                     pool.putconn(conn, close=True)
[1m[94m129 |[0m                     conn = pool.getconn()
[1m[94m130 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m131 |[0m                 self._pool_stats['active_connections'] = max(
[1m[94m132 |[0m                     self._pool_stats['active_connections'],
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:135:1
    [1m[94m|[0m
[1m[94m133 |[0m                     len([c for c in pool._used if c])
[1m[94m134 |[0m                 )
[1m[94m135 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m136 |[0m                 yield conn
[1m[94m137 |[0m                 conn.commit()
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:139:1
    [1m[94m|[0m
[1m[94m137 |[0m                 conn.commit()
[1m[94m138 |[0m                 break
[1m[94m139 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m140 |[0m             except (psycopg2.OperationalError, psycopg2.InterfaceError) as e:
[1m[94m141 |[0m                 # Connection error, retry
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mF841 [0m[[1m[96m*[0m] [1mLocal variable `e` is assigned to but never used[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:140:76
    [1m[94m|[0m
[1m[94m138 |[0m                 break
[1m[94m139 |[0m                 
[1m[94m140 |[0m             except (psycopg2.OperationalError, psycopg2.InterfaceError) as e:
    [1m[94m|[0m                                                                            [1m[91m^[0m
[1m[94m141 |[0m                 # Connection error, retry
[1m[94m142 |[0m                 if conn:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove assignment to unused variable `e`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:149:1
    [1m[94m|[0m
[1m[94m147 |[0m                         pass
[1m[94m148 |[0m                     conn = None
[1m[94m149 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m150 |[0m                 if attempt < retries - 1:
[1m[94m151 |[0m                     self._pool_stats['retries'] += 1
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:156:1
    [1m[94m|[0m
[1m[94m154 |[0m                 else:
[1m[94m155 |[0m                     raise
[1m[94m156 |[0m                     
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m157 |[0m             except Exception:
[1m[94m158 |[0m                 if conn:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:161:1
    [1m[94m|[0m
[1m[94m159 |[0m                     conn.rollback()
[1m[94m160 |[0m                 raise
[1m[94m161 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m162 |[0m             finally:
[1m[94m163 |[0m                 if conn:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:170:27
    [1m[94m|[0m
[1m[94m169 |[0m     def save_categories(
[1m[94m170 |[0m         self, categories: List[Dict[str, Any]], upsert: bool = True, batch_size: int = 100
    [1m[94m|[0m                           [1m[91m^^^^[0m
[1m[94m171 |[0m     ) -> int:
[1m[94m172 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:170:32
    [1m[94m|[0m
[1m[94m169 |[0m     def save_categories(
[1m[94m170 |[0m         self, categories: List[Dict[str, Any]], upsert: bool = True, batch_size: int = 100
    [1m[94m|[0m                                [1m[91m^^^^[0m
[1m[94m171 |[0m     ) -> int:
[1m[94m172 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:206:1
    [1m[94m|[0m
[1m[94m204 |[0m                             for cat in batch
[1m[94m205 |[0m                         ]
[1m[94m206 |[0m                         
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m207 |[0m                         if upsert:
[1m[94m208 |[0m                             # Batch INSERT ... ON CONFLICT UPDATE
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:212:55
    [1m[94m|[0m
[1m[94m210 |[0m [1m[94mâ€¦[0m                     cur,
[1m[94m211 |[0m [1m[94mâ€¦[0m                     """
[1m[94m212 |[0m [1m[94mâ€¦[0m                     INSERT INTO categories 
    [1m[94m|[0m                                             [1m[91m^[0m
[1m[94m213 |[0m [1m[94mâ€¦[0m                         (category_id, name, url, image_url, parent_url, level, product_count)
[1m[94m214 |[0m [1m[94mâ€¦[0m                     VALUES %s
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:215:50
    [1m[94m|[0m
[1m[94m213 |[0m [1m[94mâ€¦[0m                         (category_id, name, url, image_url, parent_url, level, product_count)
[1m[94m214 |[0m [1m[94mâ€¦[0m                     VALUES %s
[1m[94m215 |[0m [1m[94mâ€¦[0m                     ON CONFLICT (url) 
    [1m[94m|[0m                                        [1m[91m^[0m
[1m[94m216 |[0m [1m[94mâ€¦[0m                     DO UPDATE SET
[1m[94m217 |[0m [1m[94mâ€¦[0m                         name = EXCLUDED.name,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:231:55
    [1m[94m|[0m
[1m[94m229 |[0m [1m[94mâ€¦[0m                     cur,
[1m[94m230 |[0m [1m[94mâ€¦[0m                     """
[1m[94m231 |[0m [1m[94mâ€¦[0m                     INSERT INTO categories 
    [1m[94m|[0m                                             [1m[91m^[0m
[1m[94m232 |[0m [1m[94mâ€¦[0m                         (category_id, name, url, image_url, parent_url, level, product_count)
[1m[94m233 |[0m [1m[94mâ€¦[0m                     VALUES %s
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:238:1
    [1m[94m|[0m
[1m[94m236 |[0m                                 values,
[1m[94m237 |[0m                             )
[1m[94m238 |[0m                         
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m239 |[0m                         saved_count += len(batch)
[1m[94m240 |[0m                     except Exception as e:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:248:63
    [1m[94m|[0m
[1m[94m246 |[0m [1m[94mâ€¦[0m                     cur.execute(
[1m[94m247 |[0m [1m[94mâ€¦[0m                         """
[1m[94m248 |[0m [1m[94mâ€¦[0m                         INSERT INTO categories 
    [1m[94m|[0m                                                 [1m[91m^[0m
[1m[94m249 |[0m [1m[94mâ€¦[0m                             (category_id, name, url, image_url, parent_url, level, product_count)
[1m[94m250 |[0m [1m[94mâ€¦[0m                         VALUES (%s, %s, %s, %s, %s, %s, %s)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:251:58
    [1m[94m|[0m
[1m[94m249 |[0m [1m[94mâ€¦[0m                         (category_id, name, url, image_url, parent_url, level, product_count)
[1m[94m250 |[0m [1m[94mâ€¦[0m                     VALUES (%s, %s, %s, %s, %s, %s, %s)
[1m[94m251 |[0m [1m[94mâ€¦[0m                     ON CONFLICT (url) 
    [1m[94m|[0m                                        [1m[91m^[0m
[1m[94m252 |[0m [1m[94mâ€¦[0m                     DO UPDATE SET
[1m[94m253 |[0m [1m[94mâ€¦[0m                         name = EXCLUDED.name,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:273:63
    [1m[94m|[0m
[1m[94m271 |[0m [1m[94mâ€¦[0m                     cur.execute(
[1m[94m272 |[0m [1m[94mâ€¦[0m                         """
[1m[94m273 |[0m [1m[94mâ€¦[0m                         INSERT INTO categories 
    [1m[94m|[0m                                                 [1m[91m^[0m
[1m[94m274 |[0m [1m[94mâ€¦[0m                             (category_id, name, url, image_url, parent_url, level, product_count)
[1m[94m275 |[0m [1m[94mâ€¦[0m                         VALUES (%s, %s, %s, %s, %s, %s, %s)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:295:25
    [1m[94m|[0m
[1m[94m294 |[0m     def save_products(
[1m[94m295 |[0m         self, products: List[Dict[str, Any]], upsert: bool = True, batch_size: int = 100
    [1m[94m|[0m                         [1m[91m^^^^[0m
[1m[94m296 |[0m     ) -> int:
[1m[94m297 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:295:30
    [1m[94m|[0m
[1m[94m294 |[0m     def save_products(
[1m[94m295 |[0m         self, products: List[Dict[str, Any]], upsert: bool = True, batch_size: int = 100
    [1m[94m|[0m                              [1m[91m^^^^[0m
[1m[94m296 |[0m     ) -> int:
[1m[94m297 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:344:53
    [1m[94m|[0m
[1m[94m342 |[0m [1m[94mâ€¦[0m                     cur,
[1m[94m343 |[0m [1m[94mâ€¦[0m                     """
[1m[94m344 |[0m [1m[94mâ€¦[0m                     INSERT INTO products 
    [1m[94m|[0m                                           [1m[91m^[0m
[1m[94m345 |[0m [1m[94mâ€¦[0m                         (product_id, name, url, image_url, category_url, sales_count,
[1m[94m346 |[0m [1m[94mâ€¦[0m                          price, original_price, discount_percent, rating_average, 
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:346:94
    [1m[94m|[0m
[1m[94m344 |[0m [1m[94mâ€¦[0m                     INSERT INTO products 
[1m[94m345 |[0m [1m[94mâ€¦[0m                         (product_id, name, url, image_url, category_url, sales_count,
[1m[94m346 |[0m [1m[94mâ€¦[0m                          price, original_price, discount_percent, rating_average, 
    [1m[94m|[0m                                                                                    [1m[91m^[0m
[1m[94m347 |[0m [1m[94mâ€¦[0m                          review_count, description, specifications, images)
[1m[94m348 |[0m [1m[94mâ€¦[0m                     VALUES %s
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:349:57
    [1m[94m|[0m
[1m[94m347 |[0m [1m[94mâ€¦[0m                          review_count, description, specifications, images)
[1m[94m348 |[0m [1m[94mâ€¦[0m                     VALUES %s
[1m[94m349 |[0m [1m[94mâ€¦[0m                     ON CONFLICT (product_id) 
    [1m[94m|[0m                                               [1m[91m^[0m
[1m[94m350 |[0m [1m[94mâ€¦[0m                     DO UPDATE SET
[1m[94m351 |[0m [1m[94mâ€¦[0m                         name = EXCLUDED.name,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:373:53
    [1m[94m|[0m
[1m[94m371 |[0m [1m[94mâ€¦[0m                     cur,
[1m[94m372 |[0m [1m[94mâ€¦[0m                     """
[1m[94m373 |[0m [1m[94mâ€¦[0m                     INSERT INTO products 
    [1m[94m|[0m                                           [1m[91m^[0m
[1m[94m374 |[0m [1m[94mâ€¦[0m                         (product_id, name, url, image_url, category_url, sales_count,
[1m[94m375 |[0m [1m[94mâ€¦[0m                          price, original_price, discount_percent, rating_average, 
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:375:94
    [1m[94m|[0m
[1m[94m373 |[0m [1m[94mâ€¦[0m                     INSERT INTO products 
[1m[94m374 |[0m [1m[94mâ€¦[0m                         (product_id, name, url, image_url, category_url, sales_count,
[1m[94m375 |[0m [1m[94mâ€¦[0m                          price, original_price, discount_percent, rating_average, 
    [1m[94m|[0m                                                                                    [1m[91m^[0m
[1m[94m376 |[0m [1m[94mâ€¦[0m                          review_count, description, specifications, images)
[1m[94m377 |[0m [1m[94mâ€¦[0m                     VALUES %s
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:425:46
    [1m[94m|[0m
[1m[94m423 |[0m                 cur.execute(
[1m[94m424 |[0m                     """
[1m[94m425 |[0m                     INSERT INTO crawl_history 
    [1m[94m|[0m                                              [1m[91m^[0m
[1m[94m426 |[0m                         (crawl_type, status, items_count, category_url, product_id, 
[1m[94m427 |[0m                          error_message, started_at, completed_at)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:426:84
    [1m[94m|[0m
[1m[94m424 |[0m                     """
[1m[94m425 |[0m                     INSERT INTO crawl_history 
[1m[94m426 |[0m                         (crawl_type, status, items_count, category_url, product_id, 
    [1m[94m|[0m                                                                                    [1m[91m^[0m
[1m[94m427 |[0m                          error_message, started_at, completed_at)
[1m[94m428 |[0m                     VALUES (%s, %s, %s, %s, %s, %s, %s, CURRENT_TIMESTAMP)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:443:80
    [1m[94m|[0m
[1m[94m441 |[0m                 return cur.fetchone()[0]
[1m[94m442 |[0m
[1m[94m443 |[0m     def get_products_by_category(self, category_url: str, limit: int = 100) -> List[Dict[str, Any]]:
    [1m[94m|[0m                                                                                [1m[91m^^^^[0m
[1m[94m444 |[0m         """Láº¥y danh sÃ¡ch products theo category_url"""
[1m[94m445 |[0m         with self.get_connection() as conn:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:443:85
    [1m[94m|[0m
[1m[94m441 |[0m                 return cur.fetchone()[0]
[1m[94m442 |[0m
[1m[94m443 |[0m     def get_products_by_category(self, category_url: str, limit: int = 100) -> List[Dict[str, Any]]:
    [1m[94m|[0m                                                                                     [1m[91m^^^^[0m
[1m[94m444 |[0m         """Láº¥y danh sÃ¡ch products theo category_url"""
[1m[94m445 |[0m         with self.get_connection() as conn:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:449:81
    [1m[94m|[0m
[1m[94m447 |[0m                 cur.execute(
[1m[94m448 |[0m                     """
[1m[94m449 |[0m                     SELECT product_id, name, url, image_url, sales_count, price, 
    [1m[94m|[0m                                                                                 [1m[91m^[0m
[1m[94m450 |[0m                            rating_average, review_count, crawled_at
[1m[94m451 |[0m                     FROM products
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mB905 [0m[1m`zip()` without an explicit `strict=` parameter[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:459:30
    [1m[94m|[0m
[1m[94m457 |[0m                 )
[1m[94m458 |[0m                 columns = [desc[0] for desc in cur.description]
[1m[94m459 |[0m                 return [dict(zip(columns, row)) for row in cur.fetchall()]
    [1m[94m|[0m                              [1m[91m^^^^^^^^^^^^^^^^^[0m
[1m[94m460 |[0m
[1m[94m461 |[0m     def get_category_stats(self) -> Dict[str, Any]:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mAdd explicit value for parameter `strict=`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:461:37
    [1m[94m|[0m
[1m[94m459 |[0m                 return [dict(zip(columns, row)) for row in cur.fetchall()]
[1m[94m460 |[0m
[1m[94m461 |[0m     def get_category_stats(self) -> Dict[str, Any]:
    [1m[94m|[0m                                     [1m[91m^^^^[0m
[1m[94m462 |[0m         """Láº¥y thá»‘ng kÃª tá»•ng quan vá» categories vÃ  products"""
[1m[94m463 |[0m         with self.get_connection() as conn:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW291 [0m[1mTrailing whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:467:27
    [1m[94m|[0m
[1m[94m465 |[0m                 cur.execute(
[1m[94m466 |[0m                     """
[1m[94m467 |[0m                     SELECT 
    [1m[94m|[0m                           [1m[91m^[0m
[1m[94m468 |[0m                         (SELECT COUNT(*) FROM categories) as total_categories,
[1m[94m469 |[0m                         (SELECT COUNT(*) FROM products) as total_products,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove trailing whitespace[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `dict` instead of `Dict` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\storage\postgres_storage.py:484:33
    [1m[94m|[0m
[1m[94m482 |[0m                 }
[1m[94m483 |[0m
[1m[94m484 |[0m     def get_pool_stats(self) -> Dict[str, Any]:
    [1m[94m|[0m                                 [1m[91m^^^^[0m
[1m[94m485 |[0m         """Láº¥y thá»‘ng kÃª connection pool"""
[1m[94m486 |[0m         stats = self._pool_stats.copy()
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `dict`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils.py:350:1
    [1m[94m|[0m
[1m[94m348 |[0m     """
[1m[94m349 |[0m     filepath = Path(filepath)
[1m[94m350 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m351 |[0m     # Thá»­ Ä‘á»c compressed version trÆ°á»›c
[1m[94m352 |[0m     if try_compressed:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils.py:360:1
    [1m[94m|[0m
[1m[94m358 |[0m         except ImportError:
[1m[94m359 |[0m             pass
[1m[94m360 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m361 |[0m     # Fallback vá» normal read
[1m[94m362 |[0m     if not filepath.exists():
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\__init__.py:5:1
   [1m[94m|[0m
[1m[94m 3 |[0m   """
[1m[94m 4 |[0m
[1m[94m 5 |[0m [1m[91m/[0m from .batch_processor import (
[1m[94m 6 |[0m [1m[91m|[0m     chunk_list,
[1m[94m 7 |[0m [1m[91m|[0m     process_batch_sequential,
[1m[94m 8 |[0m [1m[91m|[0m     process_batch_parallel_threads,
[1m[94m 9 |[0m [1m[91m|[0m     process_batch_parallel_processes,
[1m[94m10 |[0m [1m[91m|[0m     process_batch_with_progress,
[1m[94m11 |[0m [1m[91m|[0m     BatchProcessor,
[1m[94m12 |[0m [1m[91m|[0m )
   [1m[94m|[0m [1m[91m|_^[0m
[1m[94m13 |[0m
[1m[94m14 |[0m   __all__ = [
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mI001 [0m[[1m[96m*[0m] [1mImport block is un-sorted or un-formatted[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:6:1
   [1m[94m|[0m
[1m[94m 4 |[0m   """
[1m[94m 5 |[0m
[1m[94m 6 |[0m [1m[91m/[0m import time
[1m[94m 7 |[0m [1m[91m|[0m from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, as_completed
[1m[94m 8 |[0m [1m[91m|[0m from typing import Any, Callable, List, Optional, TypeVar, Iterator
   [1m[94m|[0m [1m[91m|___________________________________________________________________^[0m
[1m[94m 9 |[0m
[1m[94m10 |[0m   T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mOrganize imports[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`time` imported but unused[0m
 [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:6:8
  [1m[94m|[0m
[1m[94m4 |[0m """
[1m[94m5 |[0m
[1m[94m6 |[0m import time
  [1m[94m|[0m        [1m[91m^^^^[0m
[1m[94m7 |[0m from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, as_completed
[1m[94m8 |[0m from typing import Any, Callable, List, Optional, TypeVar, Iterator
  [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import: `time`[0m

[1m[91mUP035 [0m[[1m[96m*[0m] [1mImport from `collections.abc` instead: `Callable`, `Iterator`[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:8:1
   [1m[94m|[0m
[1m[94m 6 |[0m import time
[1m[94m 7 |[0m from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, as_completed
[1m[94m 8 |[0m from typing import Any, Callable, List, Optional, TypeVar, Iterator
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m 9 |[0m
[1m[94m10 |[0m T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mImport from `collections.abc`[0m

[1m[91mUP035 [0m[1m`typing.List` is deprecated, use `list` instead[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:8:1
   [1m[94m|[0m
[1m[94m 6 |[0m import time
[1m[94m 7 |[0m from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, as_completed
[1m[94m 8 |[0m from typing import Any, Callable, List, Optional, TypeVar, Iterator
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m 9 |[0m
[1m[94m10 |[0m T = TypeVar('T')
   [1m[94m|[0m

[1m[91mF401 [0m[[1m[96m*[0m] [1m`typing.Any` imported but unused[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:8:20
   [1m[94m|[0m
[1m[94m 6 |[0m import time
[1m[94m 7 |[0m from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, as_completed
[1m[94m 8 |[0m from typing import Any, Callable, List, Optional, TypeVar, Iterator
   [1m[94m|[0m                    [1m[91m^^^[0m
[1m[94m 9 |[0m
[1m[94m10 |[0m T = TypeVar('T')
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove unused import: `typing.Any`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:14:23
   [1m[94m|[0m
[1m[94m14 |[0m def chunk_list(items: List[T], chunk_size: int) -> Iterator[List[T]]:
   [1m[94m|[0m                       [1m[91m^^^^[0m
[1m[94m15 |[0m     """
[1m[94m16 |[0m     Chia list thÃ nh cÃ¡c chunks
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:14:61
   [1m[94m|[0m
[1m[94m14 |[0m def chunk_list(items: List[T], chunk_size: int) -> Iterator[List[T]]:
   [1m[94m|[0m                                                             [1m[91m^^^^[0m
[1m[94m15 |[0m     """
[1m[94m16 |[0m     Chia list thÃ nh cÃ¡c chunks
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:17:1
   [1m[94m|[0m
[1m[94m15 |[0m     """
[1m[94m16 |[0m     Chia list thÃ nh cÃ¡c chunks
[1m[94m17 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m18 |[0m     Args:
[1m[94m19 |[0m         items: List cáº§n chia
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:21:1
   [1m[94m|[0m
[1m[94m19 |[0m         items: List cáº§n chia
[1m[94m20 |[0m         chunk_size: KÃ­ch thÆ°á»›c má»—i chunk
[1m[94m21 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m22 |[0m     Yields:
[1m[94m23 |[0m         CÃ¡c chunks
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:30:12
   [1m[94m|[0m
[1m[94m29 |[0m def process_batch_sequential(
[1m[94m30 |[0m     items: List[T],
   [1m[94m|[0m            [1m[91m^^^^[0m
[1m[94m31 |[0m     processor: Callable[[T], R],
[1m[94m32 |[0m     batch_size: int = 100,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:33:15
   [1m[94m|[0m
[1m[94m31 |[0m     processor: Callable[[T], R],
[1m[94m32 |[0m     batch_size: int = 100,
[1m[94m33 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
   [1m[94m|[0m               [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m34 |[0m ) -> List[R]:
[1m[94m35 |[0m     """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:34:6
   [1m[94m|[0m
[1m[94m32 |[0m     batch_size: int = 100,
[1m[94m33 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m34 |[0m ) -> List[R]:
   [1m[94m|[0m      [1m[91m^^^^[0m
[1m[94m35 |[0m     """
[1m[94m36 |[0m     Xá»­ lÃ½ batch tuáº§n tá»±
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:37:1
   [1m[94m|[0m
[1m[94m35 |[0m     """
[1m[94m36 |[0m     Xá»­ lÃ½ batch tuáº§n tá»±
[1m[94m37 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m38 |[0m     Args:
[1m[94m39 |[0m         items: List items cáº§n xá»­ lÃ½
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:43:1
   [1m[94m|[0m
[1m[94m41 |[0m         batch_size: KÃ­ch thÆ°á»›c batch
[1m[94m42 |[0m         on_error: Callback khi cÃ³ lá»—i (item, exception)
[1m[94m43 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m44 |[0m     Returns:
[1m[94m45 |[0m         List káº¿t quáº£
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:48:1
   [1m[94m|[0m
[1m[94m46 |[0m     """
[1m[94m47 |[0m     results = []
[1m[94m48 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m49 |[0m     for batch in chunk_list(items, batch_size):
[1m[94m50 |[0m         for item in batch:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:59:1
   [1m[94m|[0m
[1m[94m57 |[0m                     on_error(item, e)
[1m[94m58 |[0m                 continue
[1m[94m59 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m60 |[0m     return results
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:64:12
   [1m[94m|[0m
[1m[94m63 |[0m def process_batch_parallel_threads(
[1m[94m64 |[0m     items: List[T],
   [1m[94m|[0m            [1m[91m^^^^[0m
[1m[94m65 |[0m     processor: Callable[[T], R],
[1m[94m66 |[0m     max_workers: int = 5,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:67:17
   [1m[94m|[0m
[1m[94m65 |[0m     processor: Callable[[T], R],
[1m[94m66 |[0m     max_workers: int = 5,
[1m[94m67 |[0m     batch_size: Optional[int] = None,
   [1m[94m|[0m                 [1m[91m^^^^^^^^^^^^^[0m
[1m[94m68 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m69 |[0m     timeout: Optional[float] = None,
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:68:15
   [1m[94m|[0m
[1m[94m66 |[0m     max_workers: int = 5,
[1m[94m67 |[0m     batch_size: Optional[int] = None,
[1m[94m68 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
   [1m[94m|[0m               [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m69 |[0m     timeout: Optional[float] = None,
[1m[94m70 |[0m ) -> List[R]:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:69:14
   [1m[94m|[0m
[1m[94m67 |[0m     batch_size: Optional[int] = None,
[1m[94m68 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m69 |[0m     timeout: Optional[float] = None,
   [1m[94m|[0m              [1m[91m^^^^^^^^^^^^^^^[0m
[1m[94m70 |[0m ) -> List[R]:
[1m[94m71 |[0m     """
   [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:70:6
   [1m[94m|[0m
[1m[94m68 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m69 |[0m     timeout: Optional[float] = None,
[1m[94m70 |[0m ) -> List[R]:
   [1m[94m|[0m      [1m[91m^^^^[0m
[1m[94m71 |[0m     """
[1m[94m72 |[0m     Xá»­ lÃ½ batch song song vá»›i threads (I/O-bound tasks)
   [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:73:1
   [1m[94m|[0m
[1m[94m71 |[0m     """
[1m[94m72 |[0m     Xá»­ lÃ½ batch song song vá»›i threads (I/O-bound tasks)
[1m[94m73 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m74 |[0m     Args:
[1m[94m75 |[0m         items: List items cáº§n xá»­ lÃ½
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:81:1
   [1m[94m|[0m
[1m[94m79 |[0m         on_error: Callback khi cÃ³ lá»—i
[1m[94m80 |[0m         timeout: Timeout cho má»—i item (giÃ¢y)
[1m[94m81 |[0m         
   [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m82 |[0m     Returns:
[1m[94m83 |[0m         List káº¿t quáº£
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:86:1
   [1m[94m|[0m
[1m[94m84 |[0m     """
[1m[94m85 |[0m     results = []
[1m[94m86 |[0m     
   [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m87 |[0m     with ThreadPoolExecutor(max_workers=max_workers) as executor:
[1m[94m88 |[0m         if batch_size:
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
  [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:95:1
   [1m[94m|[0m
[1m[94m93 |[0m                     future = executor.submit(processor, item)
[1m[94m94 |[0m                     futures[future] = item
[1m[94m95 |[0m                 
   [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m96 |[0m                 # Collect results tá»« batch nÃ y
[1m[94m97 |[0m                 for future in as_completed(futures, timeout=timeout):
   [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:109:1
    [1m[94m|[0m
[1m[94m107 |[0m             # Process táº¥t cáº£ cÃ¹ng lÃºc
[1m[94m108 |[0m             futures = {executor.submit(processor, item): item for item in items}
[1m[94m109 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m110 |[0m             for future in as_completed(futures, timeout=timeout):
[1m[94m111 |[0m                 item = futures[future]
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:119:1
    [1m[94m|[0m
[1m[94m117 |[0m                     if on_error:
[1m[94m118 |[0m                         on_error(item, e)
[1m[94m119 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m120 |[0m     return results
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:124:12
    [1m[94m|[0m
[1m[94m123 |[0m def process_batch_parallel_processes(
[1m[94m124 |[0m     items: List[T],
    [1m[94m|[0m            [1m[91m^^^^[0m
[1m[94m125 |[0m     processor: Callable[[T], R],
[1m[94m126 |[0m     max_workers: int = 4,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:127:17
    [1m[94m|[0m
[1m[94m125 |[0m     processor: Callable[[T], R],
[1m[94m126 |[0m     max_workers: int = 4,
[1m[94m127 |[0m     batch_size: Optional[int] = None,
    [1m[94m|[0m                 [1m[91m^^^^^^^^^^^^^[0m
[1m[94m128 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m129 |[0m ) -> List[R]:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:128:15
    [1m[94m|[0m
[1m[94m126 |[0m     max_workers: int = 4,
[1m[94m127 |[0m     batch_size: Optional[int] = None,
[1m[94m128 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
    [1m[94m|[0m               [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m129 |[0m ) -> List[R]:
[1m[94m130 |[0m     """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:129:6
    [1m[94m|[0m
[1m[94m127 |[0m     batch_size: Optional[int] = None,
[1m[94m128 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m129 |[0m ) -> List[R]:
    [1m[94m|[0m      [1m[91m^^^^[0m
[1m[94m130 |[0m     """
[1m[94m131 |[0m     Xá»­ lÃ½ batch song song vá»›i processes (CPU-bound tasks)
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:132:1
    [1m[94m|[0m
[1m[94m130 |[0m     """
[1m[94m131 |[0m     Xá»­ lÃ½ batch song song vá»›i processes (CPU-bound tasks)
[1m[94m132 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m133 |[0m     Args:
[1m[94m134 |[0m         items: List items cáº§n xá»­ lÃ½
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:139:1
    [1m[94m|[0m
[1m[94m137 |[0m         batch_size: KÃ­ch thÆ°á»›c batch
[1m[94m138 |[0m         on_error: Callback khi cÃ³ lá»—i
[1m[94m139 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m140 |[0m     Returns:
[1m[94m141 |[0m         List káº¿t quáº£
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:144:1
    [1m[94m|[0m
[1m[94m142 |[0m     """
[1m[94m143 |[0m     results = []
[1m[94m144 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m145 |[0m     with ProcessPoolExecutor(max_workers=max_workers) as executor:
[1m[94m146 |[0m         if batch_size:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:150:1
    [1m[94m|[0m
[1m[94m148 |[0m             for batch in chunk_list(items, batch_size):
[1m[94m149 |[0m                 futures = {executor.submit(processor, item): item for item in batch}
[1m[94m150 |[0m                 
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^^^^^[0m
[1m[94m151 |[0m                 for future in as_completed(futures):
[1m[94m152 |[0m                     item = futures[future]
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:163:1
    [1m[94m|[0m
[1m[94m161 |[0m             # Process táº¥t cáº£ cÃ¹ng lÃºc
[1m[94m162 |[0m             futures = {executor.submit(processor, item): item for item in items}
[1m[94m163 |[0m             
    [1m[94m|[0m [1m[91m^^^^^^^^^^^^[0m
[1m[94m164 |[0m             for future in as_completed(futures):
[1m[94m165 |[0m                 item = futures[future]
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:173:1
    [1m[94m|[0m
[1m[94m171 |[0m                     if on_error:
[1m[94m172 |[0m                         on_error(item, e)
[1m[94m173 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m174 |[0m     return results
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:178:12
    [1m[94m|[0m
[1m[94m177 |[0m def process_batch_with_progress(
[1m[94m178 |[0m     items: List[T],
    [1m[94m|[0m            [1m[91m^^^^[0m
[1m[94m179 |[0m     processor: Callable[[T], R],
[1m[94m180 |[0m     mode: str = "sequential",
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:183:15
    [1m[94m|[0m
[1m[94m181 |[0m     max_workers: int = 5,
[1m[94m182 |[0m     batch_size: int = 100,
[1m[94m183 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
    [1m[94m|[0m               [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m184 |[0m     progress_callback: Optional[Callable[[int, int], None]] = None,
[1m[94m185 |[0m ) -> List[R]:
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:184:24
    [1m[94m|[0m
[1m[94m182 |[0m     batch_size: int = 100,
[1m[94m183 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m184 |[0m     progress_callback: Optional[Callable[[int, int], None]] = None,
    [1m[94m|[0m                        [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m185 |[0m ) -> List[R]:
[1m[94m186 |[0m     """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:185:6
    [1m[94m|[0m
[1m[94m183 |[0m     on_error: Optional[Callable[[T, Exception], None]] = None,
[1m[94m184 |[0m     progress_callback: Optional[Callable[[int, int], None]] = None,
[1m[94m185 |[0m ) -> List[R]:
    [1m[94m|[0m      [1m[91m^^^^[0m
[1m[94m186 |[0m     """
[1m[94m187 |[0m     Xá»­ lÃ½ batch vá»›i progress tracking
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:188:1
    [1m[94m|[0m
[1m[94m186 |[0m     """
[1m[94m187 |[0m     Xá»­ lÃ½ batch vá»›i progress tracking
[1m[94m188 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m189 |[0m     Args:
[1m[94m190 |[0m         items: List items cáº§n xá»­ lÃ½
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:197:1
    [1m[94m|[0m
[1m[94m195 |[0m         on_error: Callback khi cÃ³ lá»—i
[1m[94m196 |[0m         progress_callback: Callback Ä‘á»ƒ update progress (processed, total)
[1m[94m197 |[0m         
    [1m[94m|[0m [1m[91m^^^^^^^^[0m
[1m[94m198 |[0m     Returns:
[1m[94m199 |[0m         List káº¿t quáº£
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:203:1
    [1m[94m|[0m
[1m[94m201 |[0m     total = len(items)
[1m[94m202 |[0m     processed = 0
[1m[94m203 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m204 |[0m     def processor_with_progress(item: T) -> R:
[1m[94m205 |[0m         nonlocal processed
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:211:1
    [1m[94m|[0m
[1m[94m209 |[0m             progress_callback(processed, total)
[1m[94m210 |[0m         return result
[1m[94m211 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m212 |[0m     if mode == "sequential":
[1m[94m213 |[0m         return process_batch_sequential(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:230:1
    [1m[94m|[0m
[1m[94m228 |[0m class BatchProcessor:
[1m[94m229 |[0m     """Batch processor vá»›i configurable options"""
[1m[94m230 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m231 |[0m     def __init__(
[1m[94m232 |[0m         self,
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP045 [0m[[1m[96m*[0m] [1mUse `X | None` for type annotations[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:236:19
    [1m[94m|[0m
[1m[94m234 |[0m         max_workers: int = 5,
[1m[94m235 |[0m         batch_size: int = 100,
[1m[94m236 |[0m         on_error: Optional[Callable[[T, Exception], None]] = None,
    [1m[94m|[0m                   [1m[91m^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[0m
[1m[94m237 |[0m     ):
[1m[94m238 |[0m         """
    [1m[94m|[0m
[1m[96mhelp[0m: [1mConvert to `X | None`[0m

[1m[91mW293 [0m[[1m[96m*[0m] [1mBlank line contains whitespace[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:249:1
    [1m[94m|[0m
[1m[94m247 |[0m         self.batch_size = batch_size
[1m[94m248 |[0m         self.on_error = on_error
[1m[94m249 |[0m     
    [1m[94m|[0m [1m[91m^^^^[0m
[1m[94m250 |[0m     def process(self, items: List[T], processor: Callable[[T], R]) -> List[R]:
[1m[94m251 |[0m         """Xá»­ lÃ½ items"""
    [1m[94m|[0m
[1m[96mhelp[0m: [1mRemove whitespace from blank line[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:250:30
    [1m[94m|[0m
[1m[94m248 |[0m         self.on_error = on_error
[1m[94m249 |[0m     
[1m[94m250 |[0m     def process(self, items: List[T], processor: Callable[[T], R]) -> List[R]:
    [1m[94m|[0m                              [1m[91m^^^^[0m
[1m[94m251 |[0m         """Xá»­ lÃ½ items"""
[1m[94m252 |[0m         return process_batch_with_progress(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

[1m[91mUP006 [0m[[1m[96m*[0m] [1mUse `list` instead of `List` for type annotation[0m
   [1m[94m-->[0m src\pipelines\crawl\utils\batch_processor.py:250:71
    [1m[94m|[0m
[1m[94m248 |[0m         self.on_error = on_error
[1m[94m249 |[0m     
[1m[94m250 |[0m     def process(self, items: List[T], processor: Callable[[T], R]) -> List[R]:
    [1m[94m|[0m                                                                       [1m[91m^^^^[0m
[1m[94m251 |[0m         """Xá»­ lÃ½ items"""
[1m[94m252 |[0m         return process_batch_with_progress(
    [1m[94m|[0m
[1m[96mhelp[0m: [1mReplace with `list`[0m

Found 494 errors.
[[36m*[0m] 389 fixable with the `--fix` option (65 hidden fixes can be enabled with the `--unsafe-fixes` option).


============================================================
Vulture
============================================================
src\pipelines\crawl\crawl_products.py:112: unused variable 'postfix' (100% confidence)
src\pipelines\crawl\storage\redis_cache.py:254: unused variable 'exc_tb' (100% confidence)
src\pipelines\crawl\storage\redis_cache.py:254: unused variable 'exc_type' (100% confidence)
src\pipelines\crawl\storage\redis_cache.py:254: unused variable 'exc_val' (100% confidence)


============================================================
Radon CC
============================================================
E:\Project\tiki-data-pipeline\src\pipelines\crawl\build_category_tree.py
    F 21:0 build_category_tree - B (10)
    F 150:0 main - B (8)
    F 73:0 print_tree - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\crawl_categories_optimized.py
    F 247:0 crawl_category_recursive_optimized - C (16)
    F 104:0 crawl_single_category - B (9)
    F 177:0 crawl_level_parallel - B (8)
    F 339:0 main - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\crawl_categories_recursive.py
    F 27:0 crawl_category_recursive - B (10)
    F 100:0 main - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\crawl_products.py
    F 684:0 crawl_category_products - E (32)
    F 367:0 parse_products_from_next_data - D (30)
    F 502:0 parse_products_from_html - D (28)
    F 168:0 get_page_with_selenium - C (20)
    F 290:0 get_page_with_requests - C (17)
    F 900:0 crawl_products_from_categories - C (17)
    F 629:0 get_total_pages - B (9)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\crawl_products_detail.py
    F 245:0 extract_product_detail - F (171)
    F 54:0 crawl_product_detail_with_selenium - E (39)
    F 765:0 main - B (8)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\extract_category_link_selenium.py
    F 120:0 parse_categories - F (59)
    F 28:0 crawl_with_selenium - C (12)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\utils.py
    F 269:0 atomic_write_json - C (12)
    F 185:0 parse_sales_count - C (11)
    F 18:0 setup_utf8_encoding - B (7)
    F 337:0 safe_read_json - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\resilience\dead_letter_queue.py
    M 273:4 DeadLetterQueue._remove_oldest - B (7)
    M 28:4 DeadLetterQueue.__init__ - B (6)
    M 211:4 DeadLetterQueue._list_from_file - B (6)
    M 235:4 DeadLetterQueue._list_from_redis - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\resilience\error_handler.py
    M 51:4 ErrorHandler.handle - C (12)
    C 17:0 ErrorHandler - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\resilience\exceptions.py
    F 189:0 classify_error - C (20)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\resilience\graceful_degradation.py
    M 70:4 GracefulDegradation._check_level - C (12)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\storage\multi_level_cache.py
    M 239:4 MultiLevelCache.get - C (12)
    M 288:4 MultiLevelCache.set - C (11)
    M 353:4 MultiLevelCache.exists - B (9)
    M 183:4 MultiLevelCache.__init__ - B (8)
    M 109:4 FileCache.get - B (7)
    M 332:4 MultiLevelCache.delete - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\storage\postgres_storage.py
    M 106:4 PostgresStorage.get_connection - C (14)
    M 294:4 PostgresStorage.save_products - B (10)
    M 169:4 PostgresStorage.save_categories - B (9)
    C 15:0 PostgresStorage - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\storage\redis_cache.py
    M 212:4 RedisLock.acquire - B (6)
E:\Project\tiki-data-pipeline\src\pipelines\crawl\utils\batch_processor.py
    F 63:0 process_batch_parallel_threads - C (13)
    F 123:0 process_batch_parallel_processes - C (13)
    F 29:0 process_batch_sequential - B (6)


============================================================
Radon MI
============================================================
E:\Project\tiki-data-pipeline\src\pipelines\crawl\crawl_products.py - B
E:\Project\tiki-data-pipeline\src\pipelines\crawl\crawl_products_detail.py - B


============================================================
Pylint
============================================================
Error: [WinError 2] The system cannot find the file specified

============================================================
Mypy
============================================================
Error: [WinError 2] The system cannot find the file specified
